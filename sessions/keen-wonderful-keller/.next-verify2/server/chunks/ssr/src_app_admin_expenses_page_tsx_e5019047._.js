module.exports=[1652,a=>{"use strict";var b=a.i(87924),c=a.i(72131);a.i(69387);var d=a.i(60574),e=a.i(79353);function f(){let a,f,g,h,i,j,k,l,[m,n]=(0,c.useState)("daily"),[o,p]=(0,c.useState)([]),[q,r]=(0,c.useState)([]),[s,t]=(0,c.useState)(!0),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)("30days"),[y,z]=(0,c.useState)({description:"",amount:0,category:"Other",date:new Date().toISOString().split("T")[0],gst_applied:!1});(0,c.useEffect)(()=>{(async()=>{try{let a=(await (0,d.getDocs)((0,d.collection)(e.db,"orders"))).docs.map(a=>({id:a.id,...a.data()}));p(a);let b=(await (0,d.getDocs)((0,d.collection)(e.db,"expenses"))).docs.map(a=>({id:a.id,...a.data()}));r(b),t(!1)}catch(a){console.error("Error fetching data:",a),t(!1)}})()},[]);let A=(()=>{let a=new Date,b=new Date;switch(w){case"7days":b.setDate(a.getDate()-7);break;case"30days":b.setDate(a.getDate()-30);break;case"90days":b.setDate(a.getDate()-90)}return o.filter(a=>{let c=new Date(a.created_at);return"all"===w||c>=b})})(),B=(()=>{let a=new Date,b=new Date;switch(w){case"7days":b.setDate(a.getDate()-7);break;case"30days":b.setDate(a.getDate()-30);break;case"90days":b.setDate(a.getDate()-90)}return q.filter(a=>{let c=new Date(a.date);return"all"===w||c>=b})})(),C=A.reduce((a,b)=>a+(b.total||0),0),D=B.reduce((a,b)=>a+b.amount,0),E=C-D,F=.1*C,G=C>0?E/C*100:0,H=B.reduce((a,b)=>(a[b.category]=(a[b.category]||0)+b.amount,a),{}),I=async()=>{if(y.description&&!(y.amount<=0))try{let a={...y,date:new Date(y.date).toISOString(),amount:y.gst_applied?1.05*y.amount:y.amount,created_at:new Date().toISOString()};await (0,d.addDoc)((0,d.collection)(e.db,"expenses"),a),r([...q,{id:Math.random().toString(),...a}]),z({description:"",amount:0,category:"Other",date:new Date().toISOString().split("T")[0],gst_applied:!1}),v(!1)}catch(a){console.error("Error adding expense:",a)}},J=async a=>{try{await (0,d.deleteDoc)((0,d.doc)(e.db,"expenses",a)),r(q.filter(b=>b.id!==a))}catch(a){console.error("Error deleting expense:",a)}};if(s)return(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsx)("div",{className:"text-white",children:"Loading finances..."})});let K=(a=new Date(new Date().getFullYear(),0,1),f=o.filter(b=>new Date(b.created_at)>=a),g=q.filter(b=>new Date(b.date)>=a),h=f.reduce((a,b)=>a+(b.total||0),0),i=g.reduce((a,b)=>a+b.amount,0),{ytdRevenue:h,ytdExpensesTotal:i,ytdGST:j=g.filter(a=>a.gst_applied).reduce((a,b)=>a+.05*b.amount,0),estimatedTax:.25*h-j}),L=(k={},A.forEach(a=>{let b=new Date(a.created_at).toISOString().split("T")[0];k[b]||(k[b]={date:b,revenue:0,expenses:0,net:0,impact:0,margin:0}),k[b].revenue+=a.total||0}),B.forEach(a=>{let b=new Date(a.date).toISOString().split("T")[0];k[b]||(k[b]={date:b,revenue:0,expenses:0,net:0,impact:0,margin:0}),k[b].expenses+=a.amount}),Object.values(k).map(a=>({...a,impact:.1*a.revenue,net:a.revenue-a.expenses,margin:a.revenue>0?(a.revenue-a.expenses)/a.revenue*100:0})).sort((a,b)=>new Date(b.date).getTime()-new Date(a.date).getTime())),M=(l={},A.forEach(a=>{let b=new Date(a.created_at).toISOString().slice(0,7);l[b]||(l[b]={date:b,revenue:0,expenses:0,net:0,impact:0,margin:0}),l[b].revenue+=a.total||0}),B.forEach(a=>{let b=new Date(a.date).toISOString().slice(0,7);l[b]||(l[b]={date:b,revenue:0,expenses:0,net:0,impact:0,margin:0}),l[b].expenses+=a.amount}),Object.values(l).map(a=>({...a,impact:.1*a.revenue,net:a.revenue-a.expenses,margin:a.revenue>0?(a.revenue-a.expenses)/a.revenue*100:0})).sort((a,b)=>new Date(b.date).getTime()-new Date(a.date).getTime()).slice(0,6));return(0,b.jsx)("div",{className:"min-h-screen bg-black p-6",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,b.jsx)("h1",{className:"text-4xl font-bebas text-white mb-8",children:"Finance & Expenses"}),(0,b.jsx)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-4 mb-6",children:(0,b.jsx)("div",{className:"flex gap-2 flex-wrap",children:["7days","30days","90days","all"].map(a=>(0,b.jsx)("button",{onClick:()=>x(a),className:`px-4 py-2 rounded-lg font-medium transition ${w===a?"bg-white text-black":"bg-white/[0.08] text-white hover:bg-white/[0.12]"}`,children:"7days"===a?"Last 7 Days":"30days"===a?"Last 30 Days":"90days"===a?"Last 90 Days":"All Time"},a))})}),(0,b.jsx)("div",{className:"flex gap-2 mb-6 flex-wrap",children:["daily","monthly","expenses","tax"].map(a=>(0,b.jsx)("button",{onClick:()=>n(a),className:`px-6 py-2 rounded-xl font-bebas transition ${m===a?"bg-white text-black":"bg-white/[0.08] text-white hover:bg-white/[0.12]"}`,children:"daily"===a?"Daily P&L":"monthly"===a?"Monthly P&L":"expenses"===a?"Expenses":"Tax Prep"},a))}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-8",children:[(0,b.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-4",children:[(0,b.jsx)("p",{className:"text-white/[0.6] text-xs mb-1",children:"Revenue"}),(0,b.jsxs)("p",{className:"text-2xl font-bebas text-white",children:["$",C.toFixed(2)]})]}),(0,b.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-4",children:[(0,b.jsx)("p",{className:"text-white/[0.6] text-xs mb-1",children:"Expenses"}),(0,b.jsxs)("p",{className:"text-2xl font-bebas text-white",children:["$",D.toFixed(2)]})]}),(0,b.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-4",children:[(0,b.jsx)("p",{className:"text-white/[0.6] text-xs mb-1",children:"Net Income"}),(0,b.jsxs)("p",{className:"text-2xl font-bebas text-white",children:["$",E.toFixed(2)]})]}),(0,b.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-4",children:[(0,b.jsx)("p",{className:"text-white/[0.6] text-xs mb-1",children:"Impact Fund"}),(0,b.jsxs)("p",{className:"text-2xl font-bebas text-white",children:["$",F.toFixed(2)]})]}),(0,b.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-4",children:[(0,b.jsx)("p",{className:"text-white/[0.6] text-xs mb-1",children:"Margin"}),(0,b.jsxs)("p",{className:"text-2xl font-bebas text-white",children:[G.toFixed(1),"%"]})]})]}),"daily"===m&&(0,b.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,b.jsx)("h2",{className:"text-2xl font-bebas text-white mb-6",children:"Daily P&L"}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full text-white text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-white/[0.08]",children:[(0,b.jsx)("th",{className:"text-left py-3 px-4 text-white/[0.6]",children:"Date"}),(0,b.jsx)("th",{className:"text-right py-3 px-4 text-white/[0.6]",children:"Revenue"}),(0,b.jsx)("th",{className:"text-right py-3 px-4 text-white/[0.6]",children:"Expenses"}),(0,b.jsx)("th",{className:"text-right py-3 px-4 text-white/[0.6]",children:"Net"}),(0,b.jsx)("th",{className:"text-right py-3 px-4 text-white/[0.6]",children:"Impact"}),(0,b.jsx)("th",{className:"text-right py-3 px-4 text-white/[0.6]",children:"Margin"})]})}),(0,b.jsx)("tbody",{children:L.map(a=>(0,b.jsxs)("tr",{className:"border-b border-white/[0.08] hover:bg-white/[0.02]",children:[(0,b.jsx)("td",{className:"py-3 px-4",children:a.date}),(0,b.jsxs)("td",{className:"text-right py-3 px-4",children:["$",a.revenue.toFixed(2)]}),(0,b.jsxs)("td",{className:"text-right py-3 px-4",children:["$",a.expenses.toFixed(2)]}),(0,b.jsxs)("td",{className:`text-right py-3 px-4 ${a.net>=0?"text-green-400":"text-red-400"}`,children:["$",a.net.toFixed(2)]}),(0,b.jsxs)("td",{className:"text-right py-3 px-4",children:["$",a.impact.toFixed(2)]}),(0,b.jsxs)("td",{className:"text-right py-3 px-4",children:[a.margin.toFixed(1),"%"]})]},a.date))})]})})]}),"monthly"===m&&(0,b.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,b.jsx)("h2",{className:"text-2xl font-bebas text-white mb-6",children:"Monthly P&L (Last 6 Months)"}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full text-white text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-white/[0.08]",children:[(0,b.jsx)("th",{className:"text-left py-3 px-4 text-white/[0.6]",children:"Month"}),(0,b.jsx)("th",{className:"text-right py-3 px-4 text-white/[0.6]",children:"Revenue"}),(0,b.jsx)("th",{className:"text-right py-3 px-4 text-white/[0.6]",children:"Expenses"}),(0,b.jsx)("th",{className:"text-right py-3 px-4 text-white/[0.6]",children:"Net"}),(0,b.jsx)("th",{className:"text-right py-3 px-4 text-white/[0.6]",children:"Impact"}),(0,b.jsx)("th",{className:"text-right py-3 px-4 text-white/[0.6]",children:"Margin"})]})}),(0,b.jsx)("tbody",{children:M.map(a=>(0,b.jsxs)("tr",{className:"border-b border-white/[0.08] hover:bg-white/[0.02]",children:[(0,b.jsx)("td",{className:"py-3 px-4",children:a.date}),(0,b.jsxs)("td",{className:"text-right py-3 px-4",children:["$",a.revenue.toFixed(2)]}),(0,b.jsxs)("td",{className:"text-right py-3 px-4",children:["$",a.expenses.toFixed(2)]}),(0,b.jsxs)("td",{className:`text-right py-3 px-4 ${a.net>=0?"text-green-400":"text-red-400"}`,children:["$",a.net.toFixed(2)]}),(0,b.jsxs)("td",{className:"text-right py-3 px-4",children:["$",a.impact.toFixed(2)]}),(0,b.jsxs)("td",{className:"text-right py-3 px-4",children:[a.margin.toFixed(1),"%"]})]},a.date))})]})})]}),"expenses"===m&&(0,b.jsxs)("div",{className:"space-y-6",children:[u&&(0,b.jsxs)("div",{className:"modal-panel bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,b.jsx)("h3",{className:"text-xl font-bebas text-white mb-4",children:"Add Expense"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("input",{type:"text",placeholder:"Description",value:y.description,onChange:a=>z({...y,description:a.target.value}),className:"input-premium w-full bg-white/[0.05] border border-white/[0.08] text-white"}),(0,b.jsx)("input",{type:"number",placeholder:"Amount",value:y.amount,onChange:a=>z({...y,amount:parseFloat(a.target.value)}),className:"input-premium w-full bg-white/[0.05] border border-white/[0.08] text-white"}),(0,b.jsxs)("select",{value:y.category,onChange:a=>z({...y,category:a.target.value}),className:"input-premium w-full bg-white/[0.05] border border-white/[0.08] text-white",children:[(0,b.jsx)("option",{value:"Shipping",children:"Shipping"}),(0,b.jsx)("option",{value:"Marketing",children:"Marketing"}),(0,b.jsx)("option",{value:"Software",children:"Software"}),(0,b.jsx)("option",{value:"Inventory",children:"Inventory"}),(0,b.jsx)("option",{value:"Legal-Admin",children:"Legal-Admin"}),(0,b.jsx)("option",{value:"Other",children:"Other"})]}),(0,b.jsx)("input",{type:"date",value:y.date,onChange:a=>z({...y,date:a.target.value}),className:"input-premium w-full bg-white/[0.05] border border-white/[0.08] text-white"}),(0,b.jsxs)("label",{className:"flex items-center gap-2 text-white",children:[(0,b.jsx)("input",{type:"checkbox",checked:y.gst_applied,onChange:a=>z({...y,gst_applied:a.target.checked})}),"Apply GST (5%)"]}),y.gst_applied&&(0,b.jsxs)("p",{className:"text-sm text-white/[0.6]",children:["Total with GST: $",(1.05*y.amount).toFixed(2)]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:I,className:"btn-premium flex-1 bg-white text-black hover:bg-white/[0.9]",children:"Add Expense"}),(0,b.jsx)("button",{onClick:()=>v(!1),className:"btn-premium flex-1 bg-white/[0.1] text-white hover:bg-white/[0.15]",children:"Cancel"})]})]})]}),!u&&(0,b.jsx)("button",{onClick:()=>v(!0),className:"btn-premium bg-white text-black hover:bg-white/[0.9]",children:"+ Add Expense"}),(0,b.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,b.jsx)("h3",{className:"text-xl font-bebas text-white mb-4",children:"Expenses by Category"}),(0,b.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:Object.entries(H).map(([a,c])=>(0,b.jsxs)("div",{className:"bg-white/[0.05] border border-white/[0.08] rounded-xl p-4",children:[(0,b.jsx)("p",{className:"text-white/[0.6] text-sm mb-1",children:a}),(0,b.jsxs)("p",{className:"text-xl font-bebas text-white",children:["$",c.toFixed(2)]})]},a))})]}),(0,b.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,b.jsx)("h3",{className:"text-xl font-bebas text-white mb-4",children:"Recent Expenses"}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full text-white text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-white/[0.08]",children:[(0,b.jsx)("th",{className:"text-left py-3 px-4 text-white/[0.6]",children:"Date"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 text-white/[0.6]",children:"Description"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 text-white/[0.6]",children:"Category"}),(0,b.jsx)("th",{className:"text-right py-3 px-4 text-white/[0.6]",children:"Amount"}),(0,b.jsx)("th",{className:"text-center py-3 px-4 text-white/[0.6]",children:"Action"})]})}),(0,b.jsx)("tbody",{children:B.sort((a,b)=>{let c=new Date(a.created_at);return new Date(b.created_at).getTime()-c.getTime()}).map(a=>(0,b.jsxs)("tr",{className:"border-b border-white/[0.08] hover:bg-white/[0.02]",children:[(0,b.jsx)("td",{className:"py-3 px-4",children:new Date(a.date).toLocaleDateString()}),(0,b.jsx)("td",{className:"py-3 px-4",children:a.description}),(0,b.jsx)("td",{className:"py-3 px-4",children:a.category}),(0,b.jsxs)("td",{className:"text-right py-3 px-4",children:["$",a.amount.toFixed(2)]}),(0,b.jsx)("td",{className:"text-center py-3 px-4",children:(0,b.jsx)("button",{onClick:()=>J(a.id),className:"text-red-400 hover:text-red-300",children:"Delete"})})]},a.id))})]})})]})]}),"tax"===m&&(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,b.jsx)("p",{className:"text-white/[0.6] text-sm mb-2",children:"YTD Revenue"}),(0,b.jsxs)("p",{className:"text-3xl font-bebas text-white",children:["$",K.ytdRevenue.toFixed(2)]})]}),(0,b.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,b.jsx)("p",{className:"text-white/[0.6] text-sm mb-2",children:"YTD Expenses"}),(0,b.jsxs)("p",{className:"text-3xl font-bebas text-white",children:["$",K.ytdExpensesTotal.toFixed(2)]})]}),(0,b.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,b.jsx)("p",{className:"text-white/[0.6] text-sm mb-2",children:"GST Credits"}),(0,b.jsxs)("p",{className:"text-3xl font-bebas text-white",children:["$",K.ytdGST.toFixed(2)]})]}),(0,b.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,b.jsx)("p",{className:"text-white/[0.6] text-sm mb-2",children:"Est. Tax (25%)"}),(0,b.jsxs)("p",{className:"text-3xl font-bebas text-white",children:["$",K.estimatedTax.toFixed(2)]})]})]}),(0,b.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,b.jsx)("h3",{className:"text-xl font-bebas text-white mb-4",children:"Tax Notes"}),(0,b.jsx)("p",{className:"text-white/[0.6] text-sm",children:"This is an estimate based on current year data. Consult with a tax professional for accurate tax planning and filing."})]}),(0,b.jsx)("button",{onClick:()=>{let a=new Blob([`Date,Description,Category,Amount
${B.map(a=>`${new Date(a.date).toLocaleDateString()},${a.description},${a.category},${a.amount}`).join("\n")}`],{type:"text/csv"}),b=window.URL.createObjectURL(a),c=document.createElement("a");c.href=b,c.download="expenses.csv",c.click()},className:"btn-premium bg-white text-black hover:bg-white/[0.9]",children:"Export to CSV"})]})]})})}a.s(["default",()=>f])}];

//# sourceMappingURL=src_app_admin_expenses_page_tsx_e5019047._.js.map