module.exports=[85469,a=>{"use strict";a.i(69387);var b=a.i(60574),c=a.i(79353);let d=new Set(["email","customer_email","customerEmail","phone","password","token","idToken","creditCard","ssn"]);function e(a,b,c,e){let f={level:a,message:b,timestamp:new Date().toISOString()};return c&&Object.keys(c).length>0&&(f.context=function a(b){let c={...b};for(let[b,e]of Object.entries(c))"string"==typeof e&&d.has(b)?c[b]=e.length>3?e.slice(0,3)+"***":"***":"object"!=typeof e||null===e||Array.isArray(e)||(c[b]=a(e));return c}(c)),e instanceof Error?f.error={name:e.name,message:e.message,stack:e.stack}:e&&(f.error={name:"UnknownError",message:String(e)}),f}function f(a){let b=JSON.stringify(a);"error"===a.level||"warn"===a.level?console.error(b):console.log(b)}let g={debug(a,b){},info(a,b){f(e("info",a,b))},warn(a,b,c){f(e("warn",a,b,c))},error(a,b,c){f(e("error",a,b,c))}};function h(a,d,e){(0,b.addDoc)((0,b.collection)(c.db,"admin_audit_log"),{action:a,details:d,admin_email:e||"unknown",timestamp:(0,b.serverTimestamp)(),created_at:new Date().toISOString()}).catch(b=>{g.error("Audit log write failed",{action:a},b)})}a.s(["logAdminAction",()=>h],85469)},39836,a=>{"use strict";var b=a.i(87924),c=a.i(72131);a.i(69387);var d=a.i(60574),e=a.i(79353),f=a.i(85469);function g(){let[a,g]=(0,c.useState)([]),[h,i]=(0,c.useState)([]),[j,k]=(0,c.useState)(!0),[l,m]=(0,c.useState)(""),[n,o]=(0,c.useState)(!1),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)({code:"",type:"percentage",value:0,minOrder:0,maxUses:0,expiresAt:""});(0,c.useEffect)(()=>{k(!0);let a=(0,d.query)((0,d.collection)(e.db,"discounts"),(0,d.orderBy)("created_at","desc")),b=(0,d.onSnapshot)(a,a=>{let b=[];a.forEach(a=>{let c=a.data();b.push({...c,id:a.id})}),g(b),k(!1)});return()=>b()},[]),(0,c.useEffect)(()=>{let b=a;l&&(b=b.filter(a=>a.code.toLowerCase().includes(l.toLowerCase()))),i(b)},[a,l]);let v=async a=>{if(a.preventDefault(),t.code&&t.value){s(!0);try{let a=t.code.toUpperCase(),b=await (0,d.addDoc)((0,d.collection)(e.db,"discounts"),{code:a,type:t.type,value:parseFloat(t.value.toString()),minOrder:parseFloat(t.minOrder.toString()),maxUses:parseInt(t.maxUses.toString()),currentUses:0,expiresAt:t.expiresAt,active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}),c=(0,e.getAuthClient)(),g=c?.currentUser?.email??void 0;(0,f.logAdminAction)("discount_created",{discountId:b.id,code:a,type:t.type,value:t.value},g),u({code:"",type:"percentage",value:0,minOrder:0,maxUses:0,expiresAt:""}),o(!1),s(!1)}catch(a){console.error("Error creating discount:",a),s(!1)}}},w=async a=>{s(!0);try{await (0,d.updateDoc)((0,d.doc)(e.db,"discounts",a.id),{active:!a.active,updated_at:new Date().toISOString()});let b=(0,e.getAuthClient)(),c=b?.currentUser?.email??void 0;(0,f.logAdminAction)("discount_updated",{discountId:a.id,code:a.code,previousActive:a.active,newActive:!a.active},c),s(!1)}catch(a){console.error("Error updating discount:",a),s(!1)}},x=async b=>{if(window.confirm("Delete this discount code?")){q(!0);try{let c=a.find(a=>a.id===b);await (0,d.deleteDoc)((0,d.doc)(e.db,"discounts",b));let g=(0,e.getAuthClient)(),h=g?.currentUser?.email??void 0;(0,f.logAdminAction)("discount_deleted",{discountId:b,code:c?.code},h),q(!1)}catch(a){console.error("Error deleting discount:",a),q(!1)}}},y={totalCodes:a.length,activeCodes:a.filter(a=>a.active).length,totalUses:a.reduce((a,b)=>a+b.currentUses,0),expiredCodes:a.filter(a=>new Date(a.expiresAt)<new Date).length};return(0,b.jsxs)("div",{className:"min-h-screen bg-black text-white",children:[(0,b.jsxs)("div",{className:"border-b border-white/[0.08] px-6 py-8",children:[(0,b.jsx)("h1",{className:"font-bebas text-4xl tracking-wider",children:"Discount Codes"}),(0,b.jsx)("p",{className:"text-white/60 mt-2",children:"Create and manage promotional discount codes"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 px-6 py-6",children:[(0,b.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-4",children:[(0,b.jsx)("div",{className:"text-white/60 text-sm",children:"Total Codes"}),(0,b.jsx)("div",{className:"font-bebas text-3xl mt-2",children:y.totalCodes})]}),(0,b.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-4",children:[(0,b.jsx)("div",{className:"text-emerald-300 text-sm",children:"Active Codes"}),(0,b.jsx)("div",{className:"font-bebas text-3xl mt-2",children:y.activeCodes})]}),(0,b.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-4",children:[(0,b.jsx)("div",{className:"text-blue-300 text-sm",children:"Total Uses"}),(0,b.jsx)("div",{className:"font-bebas text-3xl mt-2",children:y.totalUses})]}),(0,b.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-4",children:[(0,b.jsx)("div",{className:"text-red-300 text-sm",children:"Expired"}),(0,b.jsx)("div",{className:"font-bebas text-3xl mt-2",children:y.expiredCodes})]})]}),(0,b.jsx)("div",{className:"px-6 py-6 border-b border-white/[0.08]",children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[(0,b.jsx)("input",{type:"text",placeholder:"Search discount codes...",value:l,onChange:a=>m(a.target.value),className:"input-premium max-w-sm"}),(0,b.jsx)("button",{onClick:()=>o(!0),className:"btn-premium",children:"+ New Discount"})]})}),(0,b.jsx)("div",{className:"px-6 py-6",children:j?(0,b.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border border-white/20 border-t-white"})}):0===h.length?(0,b.jsx)("div",{className:"text-center py-12 text-white/60",children:l?"No discounts found":"No discount codes yet. Create your first one!"}):(0,b.jsx)("div",{className:"overflow-x-auto rounded-2xl border border-white/[0.08]",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{className:"bg-white/[0.03] border-b border-white/[0.08]",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-6 py-4 text-left text-white/60 text-sm font-medium",children:"Code"}),(0,b.jsx)("th",{className:"px-6 py-4 text-left text-white/60 text-sm font-medium",children:"Type"}),(0,b.jsx)("th",{className:"px-6 py-4 text-left text-white/60 text-sm font-medium",children:"Value"}),(0,b.jsx)("th",{className:"px-6 py-4 text-left text-white/60 text-sm font-medium",children:"Min Order"}),(0,b.jsx)("th",{className:"px-6 py-4 text-left text-white/60 text-sm font-medium",children:"Uses"}),(0,b.jsx)("th",{className:"px-6 py-4 text-left text-white/60 text-sm font-medium",children:"Expires"}),(0,b.jsx)("th",{className:"px-6 py-4 text-left text-white/60 text-sm font-medium",children:"Status"}),(0,b.jsx)("th",{className:"px-6 py-4 text-left text-white/60 text-sm font-medium",children:"Action"})]})}),(0,b.jsx)("tbody",{children:h.map(a=>{let c=new Date(a.expiresAt)<new Date,d=0!==a.maxUses&&a.currentUses>=a.maxUses;return(0,b.jsxs)("tr",{className:"border-b border-white/[0.08] hover:bg-white/[0.02]",children:[(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsx)("span",{className:"font-mono font-semibold",children:a.code})}),(0,b.jsx)("td",{className:"px-6 py-4 text-sm capitalize",children:a.type}),(0,b.jsx)("td",{className:"px-6 py-4 text-sm",children:"percentage"===a.type?`${a.value}%`:`$${a.value.toFixed(2)}`}),(0,b.jsxs)("td",{className:"px-6 py-4 text-sm",children:["$",a.minOrder.toFixed(2)]}),(0,b.jsx)("td",{className:"px-6 py-4 text-sm",children:(0,b.jsxs)("span",{className:d?"text-red-300":"",children:[a.currentUses,a.maxUses>0&&` / ${a.maxUses}`]})}),(0,b.jsx)("td",{className:"px-6 py-4 text-sm text-white/60",children:new Date(a.expiresAt).toLocaleDateString()}),(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsxs)("div",{className:"flex gap-2",children:[c&&(0,b.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-xs bg-red-500/20 text-red-300 border border-red-500/50",children:"Expired"}),d&&(0,b.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-xs bg-orange-500/20 text-orange-300 border border-orange-500/50",children:"Max Reached"}),!c&&!d&&a.active&&(0,b.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-xs bg-emerald-500/20 text-emerald-300 border border-emerald-500/50",children:"Active"}),!c&&!d&&!a.active&&(0,b.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-xs bg-gray-500/20 text-gray-300 border border-gray-500/50",children:"Inactive"})]})}),(0,b.jsxs)("td",{className:"px-6 py-4 text-sm space-x-2",children:[!c&&(0,b.jsx)("button",{onClick:()=>w(a),disabled:r,className:"text-blue-400 hover:text-blue-300",children:a.active?"Disable":"Enable"}),(0,b.jsx)("button",{onClick:()=>x(a.id),disabled:p,className:"text-red-400 hover:text-red-300",children:"Delete"})]})]},a.id)})})]})})}),n&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:(0,b.jsxs)("div",{className:"modal-panel max-w-md w-full",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start mb-6",children:[(0,b.jsx)("h2",{className:"font-bebas text-2xl",children:"Create Discount Code"}),(0,b.jsx)("button",{onClick:()=>o(!1),className:"text-white/60 hover:text-white",children:"âœ•"})]}),(0,b.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-white/60 text-sm block mb-2",children:"Code"}),(0,b.jsx)("input",{type:"text",value:t.code,onChange:a=>u({...t,code:a.target.value.toUpperCase()}),placeholder:"e.g., SUMMER20",className:"input-premium w-full",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-white/60 text-sm block mb-2",children:"Type"}),(0,b.jsxs)("select",{value:t.type,onChange:a=>u({...t,type:a.target.value}),className:"input-premium w-full",children:[(0,b.jsx)("option",{value:"percentage",children:"Percentage (%)"}),(0,b.jsx)("option",{value:"fixed",children:"Fixed Amount ($)"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-white/60 text-sm block mb-2",children:"percentage"===t.type?"Discount %":"Discount Amount ($)"}),(0,b.jsx)("input",{type:"number",step:"0.01",value:t.value,onChange:a=>u({...t,value:parseFloat(a.target.value)}),placeholder:"0",className:"input-premium w-full",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-white/60 text-sm block mb-2",children:"Minimum Order ($)"}),(0,b.jsx)("input",{type:"number",step:"0.01",value:t.minOrder,onChange:a=>u({...t,minOrder:parseFloat(a.target.value)}),placeholder:"0",className:"input-premium w-full"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-white/60 text-sm block mb-2",children:"Max Uses (0 = Unlimited)"}),(0,b.jsx)("input",{type:"number",value:t.maxUses,onChange:a=>u({...t,maxUses:parseInt(a.target.value)||0}),placeholder:"0",className:"input-premium w-full"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-white/60 text-sm block mb-2",children:"Expiration Date"}),(0,b.jsx)("input",{type:"datetime-local",value:t.expiresAt,onChange:a=>u({...t,expiresAt:a.target.value}),className:"input-premium w-full",required:!0})]}),(0,b.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,b.jsx)("button",{type:"submit",disabled:r,className:"btn-premium flex-1",children:r?"Creating...":"Create Discount"}),(0,b.jsx)("button",{type:"button",onClick:()=>o(!1),className:"btn-premium flex-1 bg-white/[0.05] border-white/[0.08] hover:bg-white/[0.08]",children:"Cancel"})]})]})]})})]})}a.s(["default",()=>g])}];

//# sourceMappingURL=src_f704e159._.js.map