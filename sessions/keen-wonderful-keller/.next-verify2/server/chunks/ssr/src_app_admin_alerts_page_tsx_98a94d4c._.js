module.exports=[972,a=>{"use strict";var b=a.i(87924),c=a.i(72131);a.i(69387);var d=a.i(60574),e=a.i(79353);function f(){let[a,f]=(0,c.useState)([]),[g,h]=(0,c.useState)([]),[i,j]=(0,c.useState)(!0),[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)(null),[o,p]=(0,c.useState)({amount:0,reason:""});(0,c.useEffect)(()=>{(async()=>{try{let a=(await (0,d.getDocs)((0,d.collection)(e.db,"products"))).docs.map(a=>({id:a.id,...a.data()}));f(a);let b=[];a.forEach(a=>{(a.variants||[]).forEach(c=>{Object.entries(c.sizes||{}).forEach(([d,e])=>{e<5&&b.push({productId:a.id,productName:a.name,category:a.category,color:c.color,size:d,stock:e})})})}),h(b.sort((a,b)=>a.stock-b.stock)),j(!1)}catch(a){console.error("Error fetching products:",a),j(!1)}})()},[]);let q=g.filter(a=>a.stock>0).length,r=g.filter(a=>0===a.stock).length,s=new Set(g.map(a=>a.productId)).size,t=async()=>{if(m&&!(o.amount<=0)&&o.reason)try{let b=a.find(a=>a.id===m.productId);if(!b)return;let c=(b.variants||[]).findIndex(a=>a.color===m.color);if(-1===c)return;let i=m.stock,j=i+o.amount,k=[...b.variants||[]],p={...k[c].sizes};p[m.size]=j,k[c]={...k[c],sizes:p},await (0,d.updateDoc)((0,d.doc)(e.db,"products",m.productId),{variants:k}),await (0,d.addDoc)((0,d.collection)(e.db,"inventory_logs"),{product_id:m.productId,product_name:m.productName,size:m.size,color:m.color,old_stock:i,new_stock:j,change:o.amount,reason:o.reason,user:"admin",created_at:new Date().toISOString()}),f(a.map(a=>a.id===m.productId?{...a,variants:k}:a)),h(g.map(a=>a.productId===m.productId&&a.size===m.size&&a.color===m.color?{...a,stock:j}:a).filter(a=>a.stock<5).sort((a,b)=>a.stock-b.stock)),l(!1),n(null)}catch(a){console.error("Error restocking:",a)}};return i?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsx)("div",{className:"text-white",children:"Loading alerts..."})}):(0,b.jsx)("div",{className:"min-h-screen bg-black p-6",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,b.jsx)("h1",{className:"text-4xl font-bebas text-white mb-8",children:"Low Stock Alerts"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[(0,b.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,b.jsx)("p",{className:"text-white/[0.6] text-sm mb-2",children:"Low Stock Items (<5)"}),(0,b.jsx)("p",{className:"text-4xl font-bebas text-white",children:q})]}),(0,b.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,b.jsx)("p",{className:"text-white/[0.6] text-sm mb-2",children:"Out of Stock (=0)"}),(0,b.jsx)("p",{className:"text-4xl font-bebas text-white",children:r})]}),(0,b.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,b.jsx)("p",{className:"text-white/[0.6] text-sm mb-2",children:"Products Affected"}),(0,b.jsx)("p",{className:"text-4xl font-bebas text-white",children:s})]})]}),k&&m&&(0,b.jsxs)("div",{className:"modal-panel bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6 mb-8",children:[(0,b.jsx)("h2",{className:"text-2xl font-bebas text-white mb-4",children:"Restock Item"}),(0,b.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,b.jsxs)("div",{className:"p-4 bg-white/[0.05] border border-white/[0.08] rounded-xl",children:[(0,b.jsx)("p",{className:"text-white/[0.6] text-sm",children:"Product"}),(0,b.jsx)("p",{className:"text-white font-medium",children:m.productName})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{className:"p-4 bg-white/[0.05] border border-white/[0.08] rounded-xl",children:[(0,b.jsx)("p",{className:"text-white/[0.6] text-sm",children:"Color"}),(0,b.jsx)("p",{className:"text-white font-medium",children:m.color})]}),(0,b.jsxs)("div",{className:"p-4 bg-white/[0.05] border border-white/[0.08] rounded-xl",children:[(0,b.jsx)("p",{className:"text-white/[0.6] text-sm",children:"Size"}),(0,b.jsx)("p",{className:"text-white font-medium",children:m.size})]}),(0,b.jsxs)("div",{className:"p-4 bg-white/[0.05] border border-white/[0.08] rounded-xl",children:[(0,b.jsx)("p",{className:"text-white/[0.6] text-sm",children:"Current Stock"}),(0,b.jsx)("p",{className:"text-white font-medium",children:m.stock})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-white text-sm mb-2 block",children:"Amount to Add"}),(0,b.jsx)("input",{type:"number",min:"1",value:o.amount,onChange:a=>p({...o,amount:parseInt(a.target.value)||0}),className:"input-premium w-full bg-white/[0.05] border border-white/[0.08] text-white",placeholder:"Enter quantity"}),o.amount>0&&(0,b.jsxs)("p",{className:"text-white/[0.6] text-sm mt-2",children:["New stock will be: ",m.stock+o.amount]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-white text-sm mb-2 block",children:"Reason"}),(0,b.jsx)("input",{type:"text",value:o.reason,onChange:a=>p({...o,reason:a.target.value}),className:"input-premium w-full bg-white/[0.05] border border-white/[0.08] text-white",placeholder:"e.g., Supplier delivery, Warehouse transfer"})]})]}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)("button",{onClick:t,disabled:o.amount<=0||!o.reason,className:"btn-premium flex-1 bg-white text-black hover:bg-white/[0.9] disabled:opacity-50 disabled:cursor-not-allowed",children:"Confirm Restock"}),(0,b.jsx)("button",{onClick:()=>l(!1),className:"btn-premium flex-1 bg-white/[0.1] text-white hover:bg-white/[0.15]",children:"Cancel"})]})]}),(0,b.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,b.jsx)("h2",{className:"text-2xl font-bebas text-white mb-6",children:"Low Stock Items"}),0===g.length?(0,b.jsx)("p",{className:"text-white/[0.6] text-center py-8",children:"All items are well stocked!"}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full text-white text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-white/[0.08]",children:[(0,b.jsx)("th",{className:"text-left py-3 px-4 text-white/[0.6]",children:"Product"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 text-white/[0.6]",children:"Color"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 text-white/[0.6]",children:"Size"}),(0,b.jsx)("th",{className:"text-center py-3 px-4 text-white/[0.6]",children:"Stock"}),(0,b.jsx)("th",{className:"text-center py-3 px-4 text-white/[0.6]",children:"Action"})]})}),(0,b.jsx)("tbody",{children:g.map((a,c)=>(0,b.jsxs)("tr",{className:"border-b border-white/[0.08] hover:bg-white/[0.02]",children:[(0,b.jsx)("td",{className:"py-4 px-4",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-white",children:a.productName}),(0,b.jsx)("p",{className:"text-white/[0.5] text-xs",children:a.category})]})}),(0,b.jsx)("td",{className:"py-4 px-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-4 h-4 rounded-full border border-white/[0.2]",style:{backgroundColor:a.color}}),a.color]})}),(0,b.jsx)("td",{className:"py-4 px-4",children:a.size}),(0,b.jsx)("td",{className:"py-4 px-4 text-center",children:(0,b.jsx)("span",{className:`inline-flex items-center justify-center px-3 py-1 rounded-full text-sm font-medium ${0===a.stock?"bg-red-500/[0.2] text-red-300":a.stock<=2?"bg-yellow-500/[0.2] text-yellow-300":"bg-orange-500/[0.2] text-orange-300"}`,children:a.stock})}),(0,b.jsx)("td",{className:"py-4 px-4 text-center",children:(0,b.jsx)("button",{onClick:()=>{n(a),p({amount:0,reason:""}),l(!0)},className:"btn-premium px-4 py-2 bg-white/[0.1] text-white hover:bg-white/[0.15] text-sm",children:"Restock"})})]},c))})]})})]})]})})}a.s(["default",()=>f])}];

//# sourceMappingURL=src_app_admin_alerts_page_tsx_98a94d4c._.js.map