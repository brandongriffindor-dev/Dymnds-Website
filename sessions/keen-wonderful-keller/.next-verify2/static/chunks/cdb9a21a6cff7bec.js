(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,94008,e=>{"use strict";e.i(36180);var t=e.i(98925),s=e.i(53699);e.i(47167);let r=new Set(["email","customer_email","customerEmail","phone","password","token","idToken","creditCard","ssn"]);function a(e,t,s,a){let i={level:e,message:t,timestamp:new Date().toISOString()};return s&&Object.keys(s).length>0&&(i.context=function e(t){let s={...t};for(let[t,a]of Object.entries(s))"string"==typeof a&&r.has(t)?s[t]=a.length>3?a.slice(0,3)+"***":"***":"object"!=typeof a||null===a||Array.isArray(a)||(s[t]=e(a));return s}(s)),a instanceof Error?i.error={name:a.name,message:a.message,stack:a.stack}:a&&(i.error={name:"UnknownError",message:String(a)}),i}function i(e){let t=JSON.stringify(e);"error"===e.level||"warn"===e.level?console.error(t):console.log(t)}let l={debug(e,t){},info(e,t){i(a("info",e,t))},warn(e,t,s){i(a("warn",e,t,s))},error(e,t,s){i(a("error",e,t,s))}};function n(e,r,a){(0,t.addDoc)((0,t.collection)(s.db,"admin_audit_log"),{action:e,details:r,admin_email:a||"unknown",timestamp:(0,t.serverTimestamp)(),created_at:new Date().toISOString()}).catch(t=>{l.error("Audit log write failed",{action:e},t)})}e.s(["logAdminAction",()=>n],94008)},63554,e=>{"use strict";var t=e.i(43476),s=e.i(71645);e.i(36180);var r=e.i(98925),a=e.i(53699),i=e.i(94008);function l(){let[e,l]=(0,s.useState)([]),[n,d]=(0,s.useState)([]),[c,o]=(0,s.useState)(!0),[x,m]=(0,s.useState)(""),[u,p]=(0,s.useState)(!1),[h,b]=(0,s.useState)(!1),[v,j]=(0,s.useState)(!1),[g,f]=(0,s.useState)({code:"",type:"percentage",value:0,minOrder:0,maxUses:0,expiresAt:""});(0,s.useEffect)(()=>{o(!0);let e=(0,r.query)((0,r.collection)(a.db,"discounts"),(0,r.orderBy)("created_at","desc")),t=(0,r.onSnapshot)(e,e=>{let t=[];e.forEach(e=>{let s=e.data();t.push({...s,id:e.id})}),l(t),o(!1)});return()=>t()},[]),(0,s.useEffect)(()=>{let t=e;x&&(t=t.filter(e=>e.code.toLowerCase().includes(x.toLowerCase()))),d(t)},[e,x]);let w=async e=>{if(e.preventDefault(),g.code&&g.value){j(!0);try{let e=g.code.toUpperCase(),t=await (0,r.addDoc)((0,r.collection)(a.db,"discounts"),{code:e,type:g.type,value:parseFloat(g.value.toString()),minOrder:parseFloat(g.minOrder.toString()),maxUses:parseInt(g.maxUses.toString()),currentUses:0,expiresAt:g.expiresAt,active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}),s=(0,a.getAuthClient)(),l=s?.currentUser?.email??void 0;(0,i.logAdminAction)("discount_created",{discountId:t.id,code:e,type:g.type,value:g.value},l),f({code:"",type:"percentage",value:0,minOrder:0,maxUses:0,expiresAt:""}),p(!1),j(!1)}catch(e){console.error("Error creating discount:",e),j(!1)}}},N=async e=>{j(!0);try{await (0,r.updateDoc)((0,r.doc)(a.db,"discounts",e.id),{active:!e.active,updated_at:new Date().toISOString()});let t=(0,a.getAuthClient)(),s=t?.currentUser?.email??void 0;(0,i.logAdminAction)("discount_updated",{discountId:e.id,code:e.code,previousActive:e.active,newActive:!e.active},s),j(!1)}catch(e){console.error("Error updating discount:",e),j(!1)}},y=async t=>{if(window.confirm("Delete this discount code?")){b(!0);try{let s=e.find(e=>e.id===t);await (0,r.deleteDoc)((0,r.doc)(a.db,"discounts",t));let l=(0,a.getAuthClient)(),n=l?.currentUser?.email??void 0;(0,i.logAdminAction)("discount_deleted",{discountId:t,code:s?.code},n),b(!1)}catch(e){console.error("Error deleting discount:",e),b(!1)}}},C={totalCodes:e.length,activeCodes:e.filter(e=>e.active).length,totalUses:e.reduce((e,t)=>e+t.currentUses,0),expiredCodes:e.filter(e=>new Date(e.expiresAt)<new Date).length};return(0,t.jsxs)("div",{className:"min-h-screen bg-black text-white",children:[(0,t.jsxs)("div",{className:"border-b border-white/[0.08] px-6 py-8",children:[(0,t.jsx)("h1",{className:"font-bebas text-4xl tracking-wider",children:"Discount Codes"}),(0,t.jsx)("p",{className:"text-white/60 mt-2",children:"Create and manage promotional discount codes"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 px-6 py-6",children:[(0,t.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-4",children:[(0,t.jsx)("div",{className:"text-white/60 text-sm",children:"Total Codes"}),(0,t.jsx)("div",{className:"font-bebas text-3xl mt-2",children:C.totalCodes})]}),(0,t.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-4",children:[(0,t.jsx)("div",{className:"text-emerald-300 text-sm",children:"Active Codes"}),(0,t.jsx)("div",{className:"font-bebas text-3xl mt-2",children:C.activeCodes})]}),(0,t.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-4",children:[(0,t.jsx)("div",{className:"text-blue-300 text-sm",children:"Total Uses"}),(0,t.jsx)("div",{className:"font-bebas text-3xl mt-2",children:C.totalUses})]}),(0,t.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-4",children:[(0,t.jsx)("div",{className:"text-red-300 text-sm",children:"Expired"}),(0,t.jsx)("div",{className:"font-bebas text-3xl mt-2",children:C.expiredCodes})]})]}),(0,t.jsx)("div",{className:"px-6 py-6 border-b border-white/[0.08]",children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[(0,t.jsx)("input",{type:"text",placeholder:"Search discount codes...",value:x,onChange:e=>m(e.target.value),className:"input-premium max-w-sm"}),(0,t.jsx)("button",{onClick:()=>p(!0),className:"btn-premium",children:"+ New Discount"})]})}),(0,t.jsx)("div",{className:"px-6 py-6",children:c?(0,t.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border border-white/20 border-t-white"})}):0===n.length?(0,t.jsx)("div",{className:"text-center py-12 text-white/60",children:x?"No discounts found":"No discount codes yet. Create your first one!"}):(0,t.jsx)("div",{className:"overflow-x-auto rounded-2xl border border-white/[0.08]",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{className:"bg-white/[0.03] border-b border-white/[0.08]",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-4 text-left text-white/60 text-sm font-medium",children:"Code"}),(0,t.jsx)("th",{className:"px-6 py-4 text-left text-white/60 text-sm font-medium",children:"Type"}),(0,t.jsx)("th",{className:"px-6 py-4 text-left text-white/60 text-sm font-medium",children:"Value"}),(0,t.jsx)("th",{className:"px-6 py-4 text-left text-white/60 text-sm font-medium",children:"Min Order"}),(0,t.jsx)("th",{className:"px-6 py-4 text-left text-white/60 text-sm font-medium",children:"Uses"}),(0,t.jsx)("th",{className:"px-6 py-4 text-left text-white/60 text-sm font-medium",children:"Expires"}),(0,t.jsx)("th",{className:"px-6 py-4 text-left text-white/60 text-sm font-medium",children:"Status"}),(0,t.jsx)("th",{className:"px-6 py-4 text-left text-white/60 text-sm font-medium",children:"Action"})]})}),(0,t.jsx)("tbody",{children:n.map(e=>{let s=new Date(e.expiresAt)<new Date,r=0!==e.maxUses&&e.currentUses>=e.maxUses;return(0,t.jsxs)("tr",{className:"border-b border-white/[0.08] hover:bg-white/[0.02]",children:[(0,t.jsx)("td",{className:"px-6 py-4",children:(0,t.jsx)("span",{className:"font-mono font-semibold",children:e.code})}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm capitalize",children:e.type}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm",children:"percentage"===e.type?`${e.value}%`:`$${e.value.toFixed(2)}`}),(0,t.jsxs)("td",{className:"px-6 py-4 text-sm",children:["$",e.minOrder.toFixed(2)]}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm",children:(0,t.jsxs)("span",{className:r?"text-red-300":"",children:[e.currentUses,e.maxUses>0&&` / ${e.maxUses}`]})}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm text-white/60",children:new Date(e.expiresAt).toLocaleDateString()}),(0,t.jsx)("td",{className:"px-6 py-4",children:(0,t.jsxs)("div",{className:"flex gap-2",children:[s&&(0,t.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-xs bg-red-500/20 text-red-300 border border-red-500/50",children:"Expired"}),r&&(0,t.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-xs bg-orange-500/20 text-orange-300 border border-orange-500/50",children:"Max Reached"}),!s&&!r&&e.active&&(0,t.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-xs bg-emerald-500/20 text-emerald-300 border border-emerald-500/50",children:"Active"}),!s&&!r&&!e.active&&(0,t.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-xs bg-gray-500/20 text-gray-300 border border-gray-500/50",children:"Inactive"})]})}),(0,t.jsxs)("td",{className:"px-6 py-4 text-sm space-x-2",children:[!s&&(0,t.jsx)("button",{onClick:()=>N(e),disabled:v,className:"text-blue-400 hover:text-blue-300",children:e.active?"Disable":"Enable"}),(0,t.jsx)("button",{onClick:()=>y(e.id),disabled:h,className:"text-red-400 hover:text-red-300",children:"Delete"})]})]},e.id)})})]})})}),u&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:(0,t.jsxs)("div",{className:"modal-panel max-w-md w-full",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-6",children:[(0,t.jsx)("h2",{className:"font-bebas text-2xl",children:"Create Discount Code"}),(0,t.jsx)("button",{onClick:()=>p(!1),className:"text-white/60 hover:text-white",children:"âœ•"})]}),(0,t.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-white/60 text-sm block mb-2",children:"Code"}),(0,t.jsx)("input",{type:"text",value:g.code,onChange:e=>f({...g,code:e.target.value.toUpperCase()}),placeholder:"e.g., SUMMER20",className:"input-premium w-full",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-white/60 text-sm block mb-2",children:"Type"}),(0,t.jsxs)("select",{value:g.type,onChange:e=>f({...g,type:e.target.value}),className:"input-premium w-full",children:[(0,t.jsx)("option",{value:"percentage",children:"Percentage (%)"}),(0,t.jsx)("option",{value:"fixed",children:"Fixed Amount ($)"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-white/60 text-sm block mb-2",children:"percentage"===g.type?"Discount %":"Discount Amount ($)"}),(0,t.jsx)("input",{type:"number",step:"0.01",value:g.value,onChange:e=>f({...g,value:parseFloat(e.target.value)}),placeholder:"0",className:"input-premium w-full",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-white/60 text-sm block mb-2",children:"Minimum Order ($)"}),(0,t.jsx)("input",{type:"number",step:"0.01",value:g.minOrder,onChange:e=>f({...g,minOrder:parseFloat(e.target.value)}),placeholder:"0",className:"input-premium w-full"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-white/60 text-sm block mb-2",children:"Max Uses (0 = Unlimited)"}),(0,t.jsx)("input",{type:"number",value:g.maxUses,onChange:e=>f({...g,maxUses:parseInt(e.target.value)||0}),placeholder:"0",className:"input-premium w-full"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-white/60 text-sm block mb-2",children:"Expiration Date"}),(0,t.jsx)("input",{type:"datetime-local",value:g.expiresAt,onChange:e=>f({...g,expiresAt:e.target.value}),className:"input-premium w-full",required:!0})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,t.jsx)("button",{type:"submit",disabled:v,className:"btn-premium flex-1",children:v?"Creating...":"Create Discount"}),(0,t.jsx)("button",{type:"button",onClick:()=>p(!1),className:"btn-premium flex-1 bg-white/[0.05] border-white/[0.08] hover:bg-white/[0.08]",children:"Cancel"})]})]})]})})]})}e.s(["default",()=>l])}]);