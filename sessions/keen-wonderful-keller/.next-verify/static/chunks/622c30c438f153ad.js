(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,6700,e=>{"use strict";var t=e.i(43476),s=e.i(71645);e.i(36180);var r=e.i(98925),l=e.i(53699);function c(){let[e,c]=(0,s.useState)([]),[i,a]=(0,s.useState)([]),[o,d]=(0,s.useState)(!0),[n,x]=(0,s.useState)(!1),[h,m]=(0,s.useState)(null),[p,b]=(0,s.useState)({amount:0,reason:""});(0,s.useEffect)(()=>{(async()=>{try{let e=(await (0,r.getDocs)((0,r.collection)(l.db,"products"))).docs.map(e=>({id:e.id,...e.data()}));c(e);let t=[];e.forEach(e=>{(e.variants||[]).forEach(s=>{Object.entries(s.sizes||{}).forEach(([r,l])=>{l<5&&t.push({productId:e.id,productName:e.name,category:e.category,color:s.color,size:r,stock:l})})})}),a(t.sort((e,t)=>e.stock-t.stock)),d(!1)}catch(e){console.error("Error fetching products:",e),d(!1)}})()},[]);let u=i.filter(e=>e.stock>0).length,w=i.filter(e=>0===e.stock).length,j=new Set(i.map(e=>e.productId)).size,N=async()=>{if(h&&!(p.amount<=0)&&p.reason)try{let t=e.find(e=>e.id===h.productId);if(!t)return;let s=(t.variants||[]).findIndex(e=>e.color===h.color);if(-1===s)return;let o=h.stock,d=o+p.amount,n=[...t.variants||[]],b={...n[s].sizes};b[h.size]=d,n[s]={...n[s],sizes:b},await (0,r.updateDoc)((0,r.doc)(l.db,"products",h.productId),{variants:n}),await (0,r.addDoc)((0,r.collection)(l.db,"inventory_logs"),{product_id:h.productId,product_name:h.productName,size:h.size,color:h.color,old_stock:o,new_stock:d,change:p.amount,reason:p.reason,user:"admin",created_at:new Date().toISOString()}),c(e.map(e=>e.id===h.productId?{...e,variants:n}:e)),a(i.map(e=>e.productId===h.productId&&e.size===h.size&&e.color===h.color?{...e,stock:d}:e).filter(e=>e.stock<5).sort((e,t)=>e.stock-t.stock)),x(!1),m(null)}catch(e){console.error("Error restocking:",e)}};return o?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsx)("div",{className:"text-white",children:"Loading alerts..."})}):(0,t.jsx)("div",{className:"min-h-screen bg-black p-6",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,t.jsx)("h1",{className:"text-4xl font-bebas text-white mb-8",children:"Low Stock Alerts"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[(0,t.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,t.jsx)("p",{className:"text-white/[0.6] text-sm mb-2",children:"Low Stock Items (<5)"}),(0,t.jsx)("p",{className:"text-4xl font-bebas text-white",children:u})]}),(0,t.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,t.jsx)("p",{className:"text-white/[0.6] text-sm mb-2",children:"Out of Stock (=0)"}),(0,t.jsx)("p",{className:"text-4xl font-bebas text-white",children:w})]}),(0,t.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,t.jsx)("p",{className:"text-white/[0.6] text-sm mb-2",children:"Products Affected"}),(0,t.jsx)("p",{className:"text-4xl font-bebas text-white",children:j})]})]}),n&&h&&(0,t.jsxs)("div",{className:"modal-panel bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6 mb-8",children:[(0,t.jsx)("h2",{className:"text-2xl font-bebas text-white mb-4",children:"Restock Item"}),(0,t.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,t.jsxs)("div",{className:"p-4 bg-white/[0.05] border border-white/[0.08] rounded-xl",children:[(0,t.jsx)("p",{className:"text-white/[0.6] text-sm",children:"Product"}),(0,t.jsx)("p",{className:"text-white font-medium",children:h.productName})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"p-4 bg-white/[0.05] border border-white/[0.08] rounded-xl",children:[(0,t.jsx)("p",{className:"text-white/[0.6] text-sm",children:"Color"}),(0,t.jsx)("p",{className:"text-white font-medium",children:h.color})]}),(0,t.jsxs)("div",{className:"p-4 bg-white/[0.05] border border-white/[0.08] rounded-xl",children:[(0,t.jsx)("p",{className:"text-white/[0.6] text-sm",children:"Size"}),(0,t.jsx)("p",{className:"text-white font-medium",children:h.size})]}),(0,t.jsxs)("div",{className:"p-4 bg-white/[0.05] border border-white/[0.08] rounded-xl",children:[(0,t.jsx)("p",{className:"text-white/[0.6] text-sm",children:"Current Stock"}),(0,t.jsx)("p",{className:"text-white font-medium",children:h.stock})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-white text-sm mb-2 block",children:"Amount to Add"}),(0,t.jsx)("input",{type:"number",min:"1",value:p.amount,onChange:e=>b({...p,amount:parseInt(e.target.value)||0}),className:"input-premium w-full bg-white/[0.05] border border-white/[0.08] text-white",placeholder:"Enter quantity"}),p.amount>0&&(0,t.jsxs)("p",{className:"text-white/[0.6] text-sm mt-2",children:["New stock will be: ",h.stock+p.amount]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-white text-sm mb-2 block",children:"Reason"}),(0,t.jsx)("input",{type:"text",value:p.reason,onChange:e=>b({...p,reason:e.target.value}),className:"input-premium w-full bg-white/[0.05] border border-white/[0.08] text-white",placeholder:"e.g., Supplier delivery, Warehouse transfer"})]})]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:N,disabled:p.amount<=0||!p.reason,className:"btn-premium flex-1 bg-white text-black hover:bg-white/[0.9] disabled:opacity-50 disabled:cursor-not-allowed",children:"Confirm Restock"}),(0,t.jsx)("button",{onClick:()=>x(!1),className:"btn-premium flex-1 bg-white/[0.1] text-white hover:bg-white/[0.15]",children:"Cancel"})]})]}),(0,t.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bebas text-white mb-6",children:"Low Stock Items"}),0===i.length?(0,t.jsx)("p",{className:"text-white/[0.6] text-center py-8",children:"All items are well stocked!"}):(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-white text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-white/[0.08]",children:[(0,t.jsx)("th",{className:"text-left py-3 px-4 text-white/[0.6]",children:"Product"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 text-white/[0.6]",children:"Color"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 text-white/[0.6]",children:"Size"}),(0,t.jsx)("th",{className:"text-center py-3 px-4 text-white/[0.6]",children:"Stock"}),(0,t.jsx)("th",{className:"text-center py-3 px-4 text-white/[0.6]",children:"Action"})]})}),(0,t.jsx)("tbody",{children:i.map((e,s)=>(0,t.jsxs)("tr",{className:"border-b border-white/[0.08] hover:bg-white/[0.02]",children:[(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-white",children:e.productName}),(0,t.jsx)("p",{className:"text-white/[0.5] text-xs",children:e.category})]})}),(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-4 h-4 rounded-full border border-white/[0.2]",style:{backgroundColor:e.color}}),e.color]})}),(0,t.jsx)("td",{className:"py-4 px-4",children:e.size}),(0,t.jsx)("td",{className:"py-4 px-4 text-center",children:(0,t.jsx)("span",{className:`inline-flex items-center justify-center px-3 py-1 rounded-full text-sm font-medium ${0===e.stock?"bg-red-500/[0.2] text-red-300":e.stock<=2?"bg-yellow-500/[0.2] text-yellow-300":"bg-orange-500/[0.2] text-orange-300"}`,children:e.stock})}),(0,t.jsx)("td",{className:"py-4 px-4 text-center",children:(0,t.jsx)("button",{onClick:()=>{m(e),b({amount:0,reason:""}),x(!0)},className:"btn-premium px-4 py-2 bg-white/[0.1] text-white hover:bg-white/[0.15] text-sm",children:"Restock"})})]},s))})]})})]})]})})}e.s(["default",()=>c])}]);