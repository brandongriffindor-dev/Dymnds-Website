(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,61580,e=>{"use strict";var t=e.i(43476),s=e.i(71645);e.i(36180);var a=e.i(98925),i=e.i(53699);function r(){let e,r,l,d,n,x,c,h,[o,p]=(0,s.useState)("daily"),[m,b]=(0,s.useState)([]),[w,g]=(0,s.useState)([]),[u,j]=(0,s.useState)(!0),[N,y]=(0,s.useState)(!1),[v,f]=(0,s.useState)("30days"),[D,S]=(0,s.useState)({description:"",amount:0,category:"Other",date:new Date().toISOString().split("T")[0],gst_applied:!1});(0,s.useEffect)(()=>{(async()=>{try{let e=(await (0,a.getDocs)((0,a.collection)(i.db,"orders"))).docs.map(e=>({id:e.id,...e.data()}));b(e);let t=(await (0,a.getDocs)((0,a.collection)(i.db,"expenses"))).docs.map(e=>({id:e.id,...e.data()}));g(t),j(!1)}catch(e){console.error("Error fetching data:",e),j(!1)}})()},[]);let T=(()=>{let e=new Date,t=new Date;switch(v){case"7days":t.setDate(e.getDate()-7);break;case"30days":t.setDate(e.getDate()-30);break;case"90days":t.setDate(e.getDate()-90)}return m.filter(e=>{let s=new Date(e.created_at);return"all"===v||s>=t})})(),$=(()=>{let e=new Date,t=new Date;switch(v){case"7days":t.setDate(e.getDate()-7);break;case"30days":t.setDate(e.getDate()-30);break;case"90days":t.setDate(e.getDate()-90)}return w.filter(e=>{let s=new Date(e.date);return"all"===v||s>=t})})(),F=T.reduce((e,t)=>e+(t.total||0),0),k=$.reduce((e,t)=>e+t.amount,0),E=F-k,C=.1*F,O=F>0?E/F*100:0,_=$.reduce((e,t)=>(e[t.category]=(e[t.category]||0)+t.amount,e),{}),L=async()=>{if(D.description&&!(D.amount<=0))try{let e={...D,date:new Date(D.date).toISOString(),amount:D.gst_applied?1.05*D.amount:D.amount,created_at:new Date().toISOString()};await (0,a.addDoc)((0,a.collection)(i.db,"expenses"),e),g([...w,{id:Math.random().toString(),...e}]),S({description:"",amount:0,category:"Other",date:new Date().toISOString().split("T")[0],gst_applied:!1}),y(!1)}catch(e){console.error("Error adding expense:",e)}},I=async e=>{try{await (0,a.deleteDoc)((0,a.doc)(i.db,"expenses",e)),g(w.filter(t=>t.id!==e))}catch(e){console.error("Error deleting expense:",e)}};if(u)return(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsx)("div",{className:"text-white",children:"Loading finances..."})});let A=(e=new Date(new Date().getFullYear(),0,1),r=m.filter(t=>new Date(t.created_at)>=e),l=w.filter(t=>new Date(t.date)>=e),d=r.reduce((e,t)=>e+(t.total||0),0),n=l.reduce((e,t)=>e+t.amount,0),{ytdRevenue:d,ytdExpensesTotal:n,ytdGST:x=l.filter(e=>e.gst_applied).reduce((e,t)=>e+.05*t.amount,0),estimatedTax:.25*d-x}),M=(c={},T.forEach(e=>{let t=new Date(e.created_at).toISOString().split("T")[0];c[t]||(c[t]={date:t,revenue:0,expenses:0,net:0,impact:0,margin:0}),c[t].revenue+=e.total||0}),$.forEach(e=>{let t=new Date(e.date).toISOString().split("T")[0];c[t]||(c[t]={date:t,revenue:0,expenses:0,net:0,impact:0,margin:0}),c[t].expenses+=e.amount}),Object.values(c).map(e=>({...e,impact:.1*e.revenue,net:e.revenue-e.expenses,margin:e.revenue>0?(e.revenue-e.expenses)/e.revenue*100:0})).sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime())),R=(h={},T.forEach(e=>{let t=new Date(e.created_at).toISOString().slice(0,7);h[t]||(h[t]={date:t,revenue:0,expenses:0,net:0,impact:0,margin:0}),h[t].revenue+=e.total||0}),$.forEach(e=>{let t=new Date(e.date).toISOString().slice(0,7);h[t]||(h[t]={date:t,revenue:0,expenses:0,net:0,impact:0,margin:0}),h[t].expenses+=e.amount}),Object.values(h).map(e=>({...e,impact:.1*e.revenue,net:e.revenue-e.expenses,margin:e.revenue>0?(e.revenue-e.expenses)/e.revenue*100:0})).sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()).slice(0,6));return(0,t.jsx)("div",{className:"min-h-screen bg-black p-6",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,t.jsx)("h1",{className:"text-4xl font-bebas text-white mb-8",children:"Finance & Expenses"}),(0,t.jsx)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-4 mb-6",children:(0,t.jsx)("div",{className:"flex gap-2 flex-wrap",children:["7days","30days","90days","all"].map(e=>(0,t.jsx)("button",{onClick:()=>f(e),className:`px-4 py-2 rounded-lg font-medium transition ${v===e?"bg-white text-black":"bg-white/[0.08] text-white hover:bg-white/[0.12]"}`,children:"7days"===e?"Last 7 Days":"30days"===e?"Last 30 Days":"90days"===e?"Last 90 Days":"All Time"},e))})}),(0,t.jsx)("div",{className:"flex gap-2 mb-6 flex-wrap",children:["daily","monthly","expenses","tax"].map(e=>(0,t.jsx)("button",{onClick:()=>p(e),className:`px-6 py-2 rounded-xl font-bebas transition ${o===e?"bg-white text-black":"bg-white/[0.08] text-white hover:bg-white/[0.12]"}`,children:"daily"===e?"Daily P&L":"monthly"===e?"Monthly P&L":"expenses"===e?"Expenses":"Tax Prep"},e))}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-8",children:[(0,t.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-4",children:[(0,t.jsx)("p",{className:"text-white/[0.6] text-xs mb-1",children:"Revenue"}),(0,t.jsxs)("p",{className:"text-2xl font-bebas text-white",children:["$",F.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-4",children:[(0,t.jsx)("p",{className:"text-white/[0.6] text-xs mb-1",children:"Expenses"}),(0,t.jsxs)("p",{className:"text-2xl font-bebas text-white",children:["$",k.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-4",children:[(0,t.jsx)("p",{className:"text-white/[0.6] text-xs mb-1",children:"Net Income"}),(0,t.jsxs)("p",{className:"text-2xl font-bebas text-white",children:["$",E.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-4",children:[(0,t.jsx)("p",{className:"text-white/[0.6] text-xs mb-1",children:"Impact Fund"}),(0,t.jsxs)("p",{className:"text-2xl font-bebas text-white",children:["$",C.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-4",children:[(0,t.jsx)("p",{className:"text-white/[0.6] text-xs mb-1",children:"Margin"}),(0,t.jsxs)("p",{className:"text-2xl font-bebas text-white",children:[O.toFixed(1),"%"]})]})]}),"daily"===o&&(0,t.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bebas text-white mb-6",children:"Daily P&L"}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-white text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-white/[0.08]",children:[(0,t.jsx)("th",{className:"text-left py-3 px-4 text-white/[0.6]",children:"Date"}),(0,t.jsx)("th",{className:"text-right py-3 px-4 text-white/[0.6]",children:"Revenue"}),(0,t.jsx)("th",{className:"text-right py-3 px-4 text-white/[0.6]",children:"Expenses"}),(0,t.jsx)("th",{className:"text-right py-3 px-4 text-white/[0.6]",children:"Net"}),(0,t.jsx)("th",{className:"text-right py-3 px-4 text-white/[0.6]",children:"Impact"}),(0,t.jsx)("th",{className:"text-right py-3 px-4 text-white/[0.6]",children:"Margin"})]})}),(0,t.jsx)("tbody",{children:M.map(e=>(0,t.jsxs)("tr",{className:"border-b border-white/[0.08] hover:bg-white/[0.02]",children:[(0,t.jsx)("td",{className:"py-3 px-4",children:e.date}),(0,t.jsxs)("td",{className:"text-right py-3 px-4",children:["$",e.revenue.toFixed(2)]}),(0,t.jsxs)("td",{className:"text-right py-3 px-4",children:["$",e.expenses.toFixed(2)]}),(0,t.jsxs)("td",{className:`text-right py-3 px-4 ${e.net>=0?"text-green-400":"text-red-400"}`,children:["$",e.net.toFixed(2)]}),(0,t.jsxs)("td",{className:"text-right py-3 px-4",children:["$",e.impact.toFixed(2)]}),(0,t.jsxs)("td",{className:"text-right py-3 px-4",children:[e.margin.toFixed(1),"%"]})]},e.date))})]})})]}),"monthly"===o&&(0,t.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bebas text-white mb-6",children:"Monthly P&L (Last 6 Months)"}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-white text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-white/[0.08]",children:[(0,t.jsx)("th",{className:"text-left py-3 px-4 text-white/[0.6]",children:"Month"}),(0,t.jsx)("th",{className:"text-right py-3 px-4 text-white/[0.6]",children:"Revenue"}),(0,t.jsx)("th",{className:"text-right py-3 px-4 text-white/[0.6]",children:"Expenses"}),(0,t.jsx)("th",{className:"text-right py-3 px-4 text-white/[0.6]",children:"Net"}),(0,t.jsx)("th",{className:"text-right py-3 px-4 text-white/[0.6]",children:"Impact"}),(0,t.jsx)("th",{className:"text-right py-3 px-4 text-white/[0.6]",children:"Margin"})]})}),(0,t.jsx)("tbody",{children:R.map(e=>(0,t.jsxs)("tr",{className:"border-b border-white/[0.08] hover:bg-white/[0.02]",children:[(0,t.jsx)("td",{className:"py-3 px-4",children:e.date}),(0,t.jsxs)("td",{className:"text-right py-3 px-4",children:["$",e.revenue.toFixed(2)]}),(0,t.jsxs)("td",{className:"text-right py-3 px-4",children:["$",e.expenses.toFixed(2)]}),(0,t.jsxs)("td",{className:`text-right py-3 px-4 ${e.net>=0?"text-green-400":"text-red-400"}`,children:["$",e.net.toFixed(2)]}),(0,t.jsxs)("td",{className:"text-right py-3 px-4",children:["$",e.impact.toFixed(2)]}),(0,t.jsxs)("td",{className:"text-right py-3 px-4",children:[e.margin.toFixed(1),"%"]})]},e.date))})]})})]}),"expenses"===o&&(0,t.jsxs)("div",{className:"space-y-6",children:[N&&(0,t.jsxs)("div",{className:"modal-panel bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,t.jsx)("h3",{className:"text-xl font-bebas text-white mb-4",children:"Add Expense"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("input",{type:"text",placeholder:"Description",value:D.description,onChange:e=>S({...D,description:e.target.value}),className:"input-premium w-full bg-white/[0.05] border border-white/[0.08] text-white"}),(0,t.jsx)("input",{type:"number",placeholder:"Amount",value:D.amount,onChange:e=>S({...D,amount:parseFloat(e.target.value)}),className:"input-premium w-full bg-white/[0.05] border border-white/[0.08] text-white"}),(0,t.jsxs)("select",{value:D.category,onChange:e=>S({...D,category:e.target.value}),className:"input-premium w-full bg-white/[0.05] border border-white/[0.08] text-white",children:[(0,t.jsx)("option",{value:"Shipping",children:"Shipping"}),(0,t.jsx)("option",{value:"Marketing",children:"Marketing"}),(0,t.jsx)("option",{value:"Software",children:"Software"}),(0,t.jsx)("option",{value:"Inventory",children:"Inventory"}),(0,t.jsx)("option",{value:"Legal-Admin",children:"Legal-Admin"}),(0,t.jsx)("option",{value:"Other",children:"Other"})]}),(0,t.jsx)("input",{type:"date",value:D.date,onChange:e=>S({...D,date:e.target.value}),className:"input-premium w-full bg-white/[0.05] border border-white/[0.08] text-white"}),(0,t.jsxs)("label",{className:"flex items-center gap-2 text-white",children:[(0,t.jsx)("input",{type:"checkbox",checked:D.gst_applied,onChange:e=>S({...D,gst_applied:e.target.checked})}),"Apply GST (5%)"]}),D.gst_applied&&(0,t.jsxs)("p",{className:"text-sm text-white/[0.6]",children:["Total with GST: $",(1.05*D.amount).toFixed(2)]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:L,className:"btn-premium flex-1 bg-white text-black hover:bg-white/[0.9]",children:"Add Expense"}),(0,t.jsx)("button",{onClick:()=>y(!1),className:"btn-premium flex-1 bg-white/[0.1] text-white hover:bg-white/[0.15]",children:"Cancel"})]})]})]}),!N&&(0,t.jsx)("button",{onClick:()=>y(!0),className:"btn-premium bg-white text-black hover:bg-white/[0.9]",children:"+ Add Expense"}),(0,t.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,t.jsx)("h3",{className:"text-xl font-bebas text-white mb-4",children:"Expenses by Category"}),(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:Object.entries(_).map(([e,s])=>(0,t.jsxs)("div",{className:"bg-white/[0.05] border border-white/[0.08] rounded-xl p-4",children:[(0,t.jsx)("p",{className:"text-white/[0.6] text-sm mb-1",children:e}),(0,t.jsxs)("p",{className:"text-xl font-bebas text-white",children:["$",s.toFixed(2)]})]},e))})]}),(0,t.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,t.jsx)("h3",{className:"text-xl font-bebas text-white mb-4",children:"Recent Expenses"}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-white text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-white/[0.08]",children:[(0,t.jsx)("th",{className:"text-left py-3 px-4 text-white/[0.6]",children:"Date"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 text-white/[0.6]",children:"Description"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 text-white/[0.6]",children:"Category"}),(0,t.jsx)("th",{className:"text-right py-3 px-4 text-white/[0.6]",children:"Amount"}),(0,t.jsx)("th",{className:"text-center py-3 px-4 text-white/[0.6]",children:"Action"})]})}),(0,t.jsx)("tbody",{children:$.sort((e,t)=>{let s=new Date(e.created_at);return new Date(t.created_at).getTime()-s.getTime()}).map(e=>(0,t.jsxs)("tr",{className:"border-b border-white/[0.08] hover:bg-white/[0.02]",children:[(0,t.jsx)("td",{className:"py-3 px-4",children:new Date(e.date).toLocaleDateString()}),(0,t.jsx)("td",{className:"py-3 px-4",children:e.description}),(0,t.jsx)("td",{className:"py-3 px-4",children:e.category}),(0,t.jsxs)("td",{className:"text-right py-3 px-4",children:["$",e.amount.toFixed(2)]}),(0,t.jsx)("td",{className:"text-center py-3 px-4",children:(0,t.jsx)("button",{onClick:()=>I(e.id),className:"text-red-400 hover:text-red-300",children:"Delete"})})]},e.id))})]})})]})]}),"tax"===o&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,t.jsx)("p",{className:"text-white/[0.6] text-sm mb-2",children:"YTD Revenue"}),(0,t.jsxs)("p",{className:"text-3xl font-bebas text-white",children:["$",A.ytdRevenue.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,t.jsx)("p",{className:"text-white/[0.6] text-sm mb-2",children:"YTD Expenses"}),(0,t.jsxs)("p",{className:"text-3xl font-bebas text-white",children:["$",A.ytdExpensesTotal.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,t.jsx)("p",{className:"text-white/[0.6] text-sm mb-2",children:"GST Credits"}),(0,t.jsxs)("p",{className:"text-3xl font-bebas text-white",children:["$",A.ytdGST.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,t.jsx)("p",{className:"text-white/[0.6] text-sm mb-2",children:"Est. Tax (25%)"}),(0,t.jsxs)("p",{className:"text-3xl font-bebas text-white",children:["$",A.estimatedTax.toFixed(2)]})]})]}),(0,t.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-6",children:[(0,t.jsx)("h3",{className:"text-xl font-bebas text-white mb-4",children:"Tax Notes"}),(0,t.jsx)("p",{className:"text-white/[0.6] text-sm",children:"This is an estimate based on current year data. Consult with a tax professional for accurate tax planning and filing."})]}),(0,t.jsx)("button",{onClick:()=>{let e=new Blob([`Date,Description,Category,Amount
${$.map(e=>`${new Date(e.date).toLocaleDateString()},${e.description},${e.category},${e.amount}`).join("\n")}`],{type:"text/csv"}),t=window.URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="expenses.csv",s.click()},className:"btn-premium bg-white text-black hover:bg-white/[0.9]",children:"Export to CSV"})]})]})})}e.s(["default",()=>r])}]);