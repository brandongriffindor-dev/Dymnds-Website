{"version":3,"sources":["../../../../../../src/lib/audit-log.ts","../../../../../../src/lib/logger.ts","../../../../../../src/app/admin/discounts/page.tsx"],"sourcesContent":["import { collection, addDoc, serverTimestamp } from 'firebase/firestore';\nimport { db } from '@/lib/firebase';\nimport { logger } from '@/lib/logger';\n\nexport type AuditAction =\n  | 'order_status_updated'\n  | 'order_deleted'\n  | 'product_created'\n  | 'product_updated'\n  | 'product_deleted'\n  | 'discount_created'\n  | 'discount_updated'\n  | 'discount_deleted'\n  | 'customer_note_saved'\n  | 'inventory_adjusted'\n  | 'expense_created'\n  | 'expense_deleted'\n  | 'bulk_delete'\n  | 'message_deleted'\n  | 'waitlist_exported';\n\ninterface AuditDetails {\n  [key: string]: string | number | boolean | undefined;\n}\n\n/**\n * Logs an admin action to the admin_audit_log collection.\n * Non-blocking — fires and forgets so it never blocks UI actions.\n */\nexport function logAdminAction(\n  action: AuditAction,\n  details: AuditDetails,\n  adminEmail?: string\n): void {\n  addDoc(collection(db, 'admin_audit_log'), {\n    action,\n    details,\n    admin_email: adminEmail || 'unknown',\n    timestamp: serverTimestamp(),\n    created_at: new Date().toISOString(),\n  }).catch((error) => {\n    logger.error('Audit log write failed', { action }, error);\n  });\n}\n","/**\n * Structured JSON logger for production observability [INF-106].\n *\n * Outputs structured JSON to stdout/stderr for Vercel Logs ingestion.\n * Vercel automatically parses JSON log lines into searchable, filterable fields.\n *\n * Usage:\n *   import { logger } from '@/lib/logger';\n *   logger.info('Order created', { orderId: '123', total: 99.99 });\n *   logger.error('Payment failed', { orderId: '123' }, error);\n */\n\ntype LogLevel = 'debug' | 'info' | 'warn' | 'error';\n\ninterface LogEntry {\n  level: LogLevel;\n  message: string;\n  timestamp: string;\n  context?: Record<string, unknown>;\n  error?: {\n    name: string;\n    message: string;\n    stack?: string;\n  };\n}\n\n// PII fields to mask in log output\nconst PII_FIELDS = new Set(['email', 'customer_email', 'customerEmail', 'phone', 'password', 'token', 'idToken', 'creditCard', 'ssn']);\n\nfunction maskPII(context: Record<string, unknown>): Record<string, unknown> {\n  const masked = { ...context };\n  for (const [key, value] of Object.entries(masked)) {\n    if (typeof value === 'string' && PII_FIELDS.has(key)) {\n      // Show first 3 chars + mask remainder\n      masked[key] = value.length > 3 ? value.slice(0, 3) + '***' : '***';\n    } else if (typeof value === 'object' && value !== null && !Array.isArray(value)) {\n      masked[key] = maskPII(value as Record<string, unknown>);\n    }\n  }\n  return masked;\n}\n\nfunction createLogEntry(\n  level: LogLevel,\n  message: string,\n  context?: Record<string, unknown>,\n  error?: unknown\n): LogEntry {\n  const entry: LogEntry = {\n    level,\n    message,\n    timestamp: new Date().toISOString(),\n  };\n\n  if (context && Object.keys(context).length > 0) {\n    entry.context = maskPII(context);\n  }\n\n  if (error instanceof Error) {\n    entry.error = {\n      name: error.name,\n      message: error.message,\n      stack: error.stack,\n    };\n  } else if (error) {\n    entry.error = {\n      name: 'UnknownError',\n      message: String(error),\n    };\n  }\n\n  return entry;\n}\n\nfunction emit(entry: LogEntry): void {\n  const json = JSON.stringify(entry);\n\n  if (entry.level === 'error' || entry.level === 'warn') {\n    console.error(json);\n  } else {\n    console.log(json);\n  }\n}\n\nexport const logger = {\n  debug(message: string, context?: Record<string, unknown>): void {\n    if (process.env.NODE_ENV === 'development') {\n      emit(createLogEntry('debug', message, context));\n    }\n  },\n\n  info(message: string, context?: Record<string, unknown>): void {\n    emit(createLogEntry('info', message, context));\n  },\n\n  warn(message: string, context?: Record<string, unknown>, error?: unknown): void {\n    emit(createLogEntry('warn', message, context, error));\n  },\n\n  error(message: string, context?: Record<string, unknown>, error?: unknown): void {\n    emit(createLogEntry('error', message, context, error));\n  },\n};\n","'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport {\n  collection,\n  doc,\n  updateDoc,\n  deleteDoc,\n  addDoc,\n  query,\n  orderBy,\n  onSnapshot,\n} from 'firebase/firestore';\nimport { db, getAuthClient } from '@/lib/firebase';\nimport { logAdminAction } from '@/lib/audit-log';\n\ninterface Discount {\n  id: string;\n  code: string;\n  type: 'percentage' | 'fixed';\n  value: number;\n  minOrder: number;\n  maxUses: number;\n  currentUses: number;\n  expiresAt: string;\n  active: boolean;\n  created_at: string;\n  updated_at: string;\n}\n\nexport default function DiscountsPage() {\n  const [discounts, setDiscounts] = useState<Discount[]>([]);\n  const [filteredDiscounts, setFilteredDiscounts] = useState<Discount[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [showCreateModal, setShowCreateModal] = useState(false);\n  const [deleting, setDeleting] = useState(false);\n  const [updating, setUpdating] = useState(false);\n  const [formData, setFormData] = useState({\n    code: '',\n    type: 'percentage' as 'percentage' | 'fixed',\n    value: 0,\n    minOrder: 0,\n    maxUses: 0,\n    expiresAt: '',\n  });\n\n  // Fetch discounts with real-time updates\n  useEffect(() => {\n    // eslint-disable-next-line react-hooks/set-state-in-effect\n    setLoading(true);\n    const q = query(collection(db, 'discounts'), orderBy('created_at', 'desc'));\n\n    const unsubscribe = onSnapshot(q, (snapshot) => {\n      const discountsData: Discount[] = [];\n      snapshot.forEach((doc) => {\n        const data = doc.data();\n        discountsData.push({\n          ...data,\n          id: doc.id,\n        } as Discount);\n      });\n      setDiscounts(discountsData);\n      setLoading(false);\n    });\n\n    return () => unsubscribe();\n  }, []);\n\n  // Filter discounts based on search\n  useEffect(() => {\n    let filtered = discounts;\n\n    if (searchTerm) {\n      filtered = filtered.filter((discount) =>\n        discount.code.toLowerCase().includes(searchTerm.toLowerCase())\n      );\n    }\n\n    // eslint-disable-next-line react-hooks/set-state-in-effect\n    setFilteredDiscounts(filtered);\n  }, [discounts, searchTerm]);\n\n  // Handle create discount\n  const handleCreateDiscount = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!formData.code || !formData.value) return;\n\n    setUpdating(true);\n    try {\n      const code = formData.code.toUpperCase();\n      const docRef = await addDoc(collection(db, 'discounts'), {\n        code,\n        type: formData.type,\n        value: parseFloat(formData.value.toString()),\n        minOrder: parseFloat(formData.minOrder.toString()),\n        maxUses: parseInt(formData.maxUses.toString()),\n        currentUses: 0,\n        expiresAt: formData.expiresAt,\n        active: true,\n        created_at: new Date().toISOString(),\n        updated_at: new Date().toISOString(),\n      });\n\n      // Log admin action\n      const auth = getAuthClient();\n      const adminEmail = auth?.currentUser?.email ?? undefined;\n      logAdminAction('discount_created', {\n        discountId: docRef.id,\n        code,\n        type: formData.type,\n        value: formData.value,\n      }, adminEmail);\n\n      setFormData({\n        code: '',\n        type: 'percentage',\n        value: 0,\n        minOrder: 0,\n        maxUses: 0,\n        expiresAt: '',\n      });\n      setShowCreateModal(false);\n      setUpdating(false);\n    } catch (error) {\n      console.error('Error creating discount:', error);\n      setUpdating(false);\n    }\n  };\n\n  // Handle toggle active\n  const handleToggleActive = async (discount: Discount) => {\n    setUpdating(true);\n    try {\n      await updateDoc(doc(db, 'discounts', discount.id), {\n        active: !discount.active,\n        updated_at: new Date().toISOString(),\n      });\n\n      // Log admin action\n      const auth = getAuthClient();\n      const adminEmail = auth?.currentUser?.email ?? undefined;\n      logAdminAction('discount_updated', {\n        discountId: discount.id,\n        code: discount.code,\n        previousActive: discount.active,\n        newActive: !discount.active,\n      }, adminEmail);\n\n      setUpdating(false);\n    } catch (error) {\n      console.error('Error updating discount:', error);\n      setUpdating(false);\n    }\n  };\n\n  // Handle delete\n  const handleDelete = async (discountId: string) => {\n    if (!window.confirm('Delete this discount code?')) return;\n\n    setDeleting(true);\n    try {\n      const discount = discounts.find(d => d.id === discountId);\n      await deleteDoc(doc(db, 'discounts', discountId));\n\n      // Log admin action\n      const auth = getAuthClient();\n      const adminEmail = auth?.currentUser?.email ?? undefined;\n      logAdminAction('discount_deleted', {\n        discountId,\n        code: discount?.code,\n      }, adminEmail);\n\n      setDeleting(false);\n    } catch (error) {\n      console.error('Error deleting discount:', error);\n      setDeleting(false);\n    }\n  };\n\n  // Get stats\n  const stats = {\n    totalCodes: discounts.length,\n    activeCodes: discounts.filter((d) => d.active).length,\n    totalUses: discounts.reduce((sum, d) => sum + d.currentUses, 0),\n    expiredCodes: discounts.filter((d) => new Date(d.expiresAt) < new Date()).length,\n  };\n\n  // Check if discount is expired\n  const isExpired = (expiresAt: string) => {\n    return new Date(expiresAt) < new Date();\n  };\n\n  // Check if discount is near max uses\n  const isNearMaxUses = (discount: Discount) => {\n    if (discount.maxUses === 0) return false;\n    return discount.currentUses >= discount.maxUses;\n  };\n\n  return (\n    <div className=\"min-h-screen bg-black text-white\">\n      {/* Header */}\n      <div className=\"border-b border-white/[0.08] px-6 py-8\">\n        <h1 className=\"font-bebas text-4xl tracking-wider\">Discount Codes</h1>\n        <p className=\"text-white/60 mt-2\">Create and manage promotional discount codes</p>\n      </div>\n\n      {/* Stats Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 px-6 py-6\">\n        <div className=\"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-4\">\n          <div className=\"text-white/60 text-sm\">Total Codes</div>\n          <div className=\"font-bebas text-3xl mt-2\">{stats.totalCodes}</div>\n        </div>\n        <div className=\"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-4\">\n          <div className=\"text-emerald-300 text-sm\">Active Codes</div>\n          <div className=\"font-bebas text-3xl mt-2\">{stats.activeCodes}</div>\n        </div>\n        <div className=\"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-4\">\n          <div className=\"text-blue-300 text-sm\">Total Uses</div>\n          <div className=\"font-bebas text-3xl mt-2\">{stats.totalUses}</div>\n        </div>\n        <div className=\"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-4\">\n          <div className=\"text-red-300 text-sm\">Expired</div>\n          <div className=\"font-bebas text-3xl mt-2\">{stats.expiredCodes}</div>\n        </div>\n      </div>\n\n      {/* Controls */}\n      <div className=\"px-6 py-6 border-b border-white/[0.08]\">\n        <div className=\"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between\">\n          <input\n            type=\"text\"\n            placeholder=\"Search discount codes...\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n            className=\"input-premium max-w-sm\"\n          />\n          <button\n            onClick={() => setShowCreateModal(true)}\n            className=\"btn-premium\"\n          >\n            + New Discount\n          </button>\n        </div>\n      </div>\n\n      {/* Discounts Table */}\n      <div className=\"px-6 py-6\">\n        {loading ? (\n          <div className=\"flex justify-center items-center py-12\">\n            <div className=\"animate-spin rounded-full h-8 w-8 border border-white/20 border-t-white\"></div>\n          </div>\n        ) : filteredDiscounts.length === 0 ? (\n          <div className=\"text-center py-12 text-white/60\">\n            {searchTerm ? 'No discounts found' : 'No discount codes yet. Create your first one!'}\n          </div>\n        ) : (\n          <div className=\"overflow-x-auto rounded-2xl border border-white/[0.08]\">\n            <table className=\"w-full\">\n              <thead className=\"bg-white/[0.03] border-b border-white/[0.08]\">\n                <tr>\n                  <th className=\"px-6 py-4 text-left text-white/60 text-sm font-medium\">Code</th>\n                  <th className=\"px-6 py-4 text-left text-white/60 text-sm font-medium\">Type</th>\n                  <th className=\"px-6 py-4 text-left text-white/60 text-sm font-medium\">Value</th>\n                  <th className=\"px-6 py-4 text-left text-white/60 text-sm font-medium\">Min Order</th>\n                  <th className=\"px-6 py-4 text-left text-white/60 text-sm font-medium\">Uses</th>\n                  <th className=\"px-6 py-4 text-left text-white/60 text-sm font-medium\">Expires</th>\n                  <th className=\"px-6 py-4 text-left text-white/60 text-sm font-medium\">Status</th>\n                  <th className=\"px-6 py-4 text-left text-white/60 text-sm font-medium\">Action</th>\n                </tr>\n              </thead>\n              <tbody>\n                {filteredDiscounts.map((discount) => {\n                  const expired = isExpired(discount.expiresAt);\n                  const maxUses = isNearMaxUses(discount);\n\n                  return (\n                    <tr key={discount.id} className=\"border-b border-white/[0.08] hover:bg-white/[0.02]\">\n                      <td className=\"px-6 py-4\">\n                        <span className=\"font-mono font-semibold\">{discount.code}</span>\n                      </td>\n                      <td className=\"px-6 py-4 text-sm capitalize\">{discount.type}</td>\n                      <td className=\"px-6 py-4 text-sm\">\n                        {discount.type === 'percentage' ? `${discount.value}%` : `$${discount.value.toFixed(2)}`}\n                      </td>\n                      <td className=\"px-6 py-4 text-sm\">${discount.minOrder.toFixed(2)}</td>\n                      <td className=\"px-6 py-4 text-sm\">\n                        <span className={maxUses ? 'text-red-300' : ''}>\n                          {discount.currentUses}\n                          {discount.maxUses > 0 && ` / ${discount.maxUses}`}\n                        </span>\n                      </td>\n                      <td className=\"px-6 py-4 text-sm text-white/60\">\n                        {new Date(discount.expiresAt).toLocaleDateString()}\n                      </td>\n                      <td className=\"px-6 py-4\">\n                        <div className=\"flex gap-2\">\n                          {expired && (\n                            <span className=\"inline-block px-3 py-1 rounded-full text-xs bg-red-500/20 text-red-300 border border-red-500/50\">\n                              Expired\n                            </span>\n                          )}\n                          {maxUses && (\n                            <span className=\"inline-block px-3 py-1 rounded-full text-xs bg-orange-500/20 text-orange-300 border border-orange-500/50\">\n                              Max Reached\n                            </span>\n                          )}\n                          {!expired && !maxUses && discount.active && (\n                            <span className=\"inline-block px-3 py-1 rounded-full text-xs bg-emerald-500/20 text-emerald-300 border border-emerald-500/50\">\n                              Active\n                            </span>\n                          )}\n                          {!expired && !maxUses && !discount.active && (\n                            <span className=\"inline-block px-3 py-1 rounded-full text-xs bg-gray-500/20 text-gray-300 border border-gray-500/50\">\n                              Inactive\n                            </span>\n                          )}\n                        </div>\n                      </td>\n                      <td className=\"px-6 py-4 text-sm space-x-2\">\n                        {!expired && (\n                          <button\n                            onClick={() => handleToggleActive(discount)}\n                            disabled={updating}\n                            className=\"text-blue-400 hover:text-blue-300\"\n                          >\n                            {discount.active ? 'Disable' : 'Enable'}\n                          </button>\n                        )}\n                        <button\n                          onClick={() => handleDelete(discount.id)}\n                          disabled={deleting}\n                          className=\"text-red-400 hover:text-red-300\"\n                        >\n                          Delete\n                        </button>\n                      </td>\n                    </tr>\n                  );\n                })}\n              </tbody>\n            </table>\n          </div>\n        )}\n      </div>\n\n      {/* Create Discount Modal */}\n      {showCreateModal && (\n        <div className=\"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50\">\n          <div className=\"modal-panel max-w-md w-full\">\n            <div className=\"flex justify-between items-start mb-6\">\n              <h2 className=\"font-bebas text-2xl\">Create Discount Code</h2>\n              <button\n                onClick={() => setShowCreateModal(false)}\n                className=\"text-white/60 hover:text-white\"\n              >\n                ✕\n              </button>\n            </div>\n\n            <form onSubmit={handleCreateDiscount} className=\"space-y-4\">\n              {/* Code */}\n              <div>\n                <label className=\"text-white/60 text-sm block mb-2\">Code</label>\n                <input\n                  type=\"text\"\n                  value={formData.code}\n                  onChange={(e) => setFormData({ ...formData, code: e.target.value.toUpperCase() })}\n                  placeholder=\"e.g., SUMMER20\"\n                  className=\"input-premium w-full\"\n                  required\n                />\n              </div>\n\n              {/* Type */}\n              <div>\n                <label className=\"text-white/60 text-sm block mb-2\">Type</label>\n                <select\n                  value={formData.type}\n                  onChange={(e) => setFormData({ ...formData, type: e.target.value as 'percentage' | 'fixed' })}\n                  className=\"input-premium w-full\"\n                >\n                  <option value=\"percentage\">Percentage (%)</option>\n                  <option value=\"fixed\">Fixed Amount ($)</option>\n                </select>\n              </div>\n\n              {/* Value */}\n              <div>\n                <label className=\"text-white/60 text-sm block mb-2\">\n                  {formData.type === 'percentage' ? 'Discount %' : 'Discount Amount ($)'}\n                </label>\n                <input\n                  type=\"number\"\n                  step=\"0.01\"\n                  value={formData.value}\n                  onChange={(e) => setFormData({ ...formData, value: parseFloat(e.target.value) })}\n                  placeholder=\"0\"\n                  className=\"input-premium w-full\"\n                  required\n                />\n              </div>\n\n              {/* Min Order */}\n              <div>\n                <label className=\"text-white/60 text-sm block mb-2\">Minimum Order ($)</label>\n                <input\n                  type=\"number\"\n                  step=\"0.01\"\n                  value={formData.minOrder}\n                  onChange={(e) => setFormData({ ...formData, minOrder: parseFloat(e.target.value) })}\n                  placeholder=\"0\"\n                  className=\"input-premium w-full\"\n                />\n              </div>\n\n              {/* Max Uses */}\n              <div>\n                <label className=\"text-white/60 text-sm block mb-2\">Max Uses (0 = Unlimited)</label>\n                <input\n                  type=\"number\"\n                  value={formData.maxUses}\n                  onChange={(e) => setFormData({ ...formData, maxUses: parseInt(e.target.value) || 0 })}\n                  placeholder=\"0\"\n                  className=\"input-premium w-full\"\n                />\n              </div>\n\n              {/* Expires At */}\n              <div>\n                <label className=\"text-white/60 text-sm block mb-2\">Expiration Date</label>\n                <input\n                  type=\"datetime-local\"\n                  value={formData.expiresAt}\n                  onChange={(e) => setFormData({ ...formData, expiresAt: e.target.value })}\n                  className=\"input-premium w-full\"\n                  required\n                />\n              </div>\n\n              {/* Buttons */}\n              <div className=\"flex gap-3 pt-4\">\n                <button\n                  type=\"submit\"\n                  disabled={updating}\n                  className=\"btn-premium flex-1\"\n                >\n                  {updating ? 'Creating...' : 'Create Discount'}\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => setShowCreateModal(false)}\n                  className=\"btn-premium flex-1 bg-white/[0.05] border-white/[0.08] hover:bg-white/[0.08]\"\n                >\n                  Cancel\n                </button>\n              </div>\n            </form>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"uCAAA,EAAA,CAAA,CAAA,OAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OC0BA,IAAM,EAAa,IAAI,IAAI,CAAC,QAAS,iBAAkB,gBAAiB,QAAS,WAAY,QAAS,UAAW,aAAc,MAAM,EAerI,SAAS,EACP,CAAe,CACf,CAAe,CACf,CAAiC,CACjC,CAAe,EAEf,IAAM,EAAkB,OACtB,UACA,EACA,UAAW,IAAI,OAAO,WAAW,EACnC,EAmBA,OAjBI,GAAW,OAAO,IAAI,CAAC,GAAS,MAAM,CAAG,GAAG,CAC9C,EAAM,OAAO,CAAG,AA1BpB,SAAS,EAAQ,CAAgC,EAC/C,IAAM,EAAS,CAAE,GAAG,CAAO,AAAC,EAC5B,IAAK,GAAM,CAAC,EAAK,EAAM,GAAI,OAAO,OAAO,CAAC,GACnB,KAD4B,KAC7C,OAAO,GAAsB,EAAW,GAAG,CAAC,GAE9C,CAAM,CAAC,CAF6C,CAEzC,CAAG,EAAM,MAAM,CAAG,EAAI,EAAM,KAAK,CAAC,EAAG,GAAK,MAAQ,MACnC,UAAjB,OAAO,GAAgC,OAAV,CAAkB,EAAC,MAAM,OAAO,CAAC,KACvE,CAAM,CAAC,CADwE,CACpE,CAAG,EAAQ,EAAA,EAG1B,OAAO,CACT,EAe4B,EAAA,EAGtB,aAAiB,MACnB,CAD0B,CACpB,KAAK,CAAG,CACZ,KAAM,EAAM,IAAI,CAChB,QAAS,EAAM,OAAO,CACtB,MAAO,EAAM,KAAK,AACpB,EACS,IACT,EAAM,CADU,IACL,CAAG,CACZ,KAAM,eACN,QAAS,OAAO,GAClB,EAGK,CACT,CAEA,SAAS,EAAK,CAAe,EAC3B,IAAM,EAAO,KAAK,SAAS,CAAC,GAER,UAAhB,EAAM,KAAK,EAAgC,QAAQ,CAAxB,EAAM,KAAK,CACxC,QAAQ,KAAK,CAAC,GAEd,QAAQ,GAAG,CAAC,EAEhB,CAEO,IAAM,EAAS,CACpB,MAAM,CAAe,CAAE,CAAiC,EAIxD,EAEA,KAAK,CAAe,CAAE,CAAiC,EACrD,EAAK,EAAe,OAAQ,EAAS,GACvC,EAEA,KAAK,CAAe,CAAE,CAAiC,CAAE,CAAe,EACtE,EAAK,EAAe,OAAQ,EAAS,EAAS,GAChD,EAEA,MAAM,CAAe,CAAE,CAAiC,CAAE,CAAe,EACvE,EAAK,EAAe,QAAS,EAAS,EAAS,GACjD,CACF,EDzEO,SAAS,EACd,CAAmB,CACnB,CAAqB,CACrB,CAAmB,EAEnB,CAAA,EAAA,EAAA,MAAA,AAAM,EAAC,CAAA,EAAA,EAAA,UAAU,AAAV,EAAW,EAAA,EAAE,CAAE,mBAAoB,QACxC,UACA,EACA,YAAa,GAAc,UAC3B,UAAW,CAAA,EAAA,EAAA,eAAA,AAAe,IAC1B,WAAY,IAAI,OAAO,WAAW,EACpC,GAAG,KAAK,CAAE,AAAD,IACP,EAAO,KAAK,CAAC,yBAA0B,QAAE,CAAO,EAAG,EACrD,EACF,8EEzCA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,CAAA,CAAA,OAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OAUA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAgBe,SAAS,IACtB,GAAM,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAa,EAAE,EACnD,CAAC,EAAmB,EAAqB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAa,EAAE,EACnE,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACjC,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACvC,CAAC,EAAiB,EAAmB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACjD,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACnC,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,GAAS,GACnC,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,CACvC,KAAM,GACN,KAAM,aACN,MAAO,EACP,SAAU,EACV,QAAS,EACT,UAAW,EACb,GAGA,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KAER,GAAW,GACX,IAAM,EAAI,CAAA,EAAA,EAAA,KAAA,AAAK,EAAC,CAAA,EAAA,EAAA,UAAU,AAAV,EAAW,EAAA,EAAE,CAAE,aAAc,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,aAAc,SAE7D,EAAc,CAAA,EAAA,EAAA,UAAA,AAAU,EAAC,EAAI,AAAD,IAChC,IAAM,EAA4B,EAAE,CACpC,EAAS,OAAO,CAAC,AAAC,IAChB,IAAM,EAAO,EAAI,IAAI,GACrB,EAAc,IAAI,CAAC,CACjB,GAAG,CAAI,CACP,GAAI,EAAI,EAAE,AACZ,EACF,GACA,EAAa,GACb,GAAW,EACb,GAEA,MAAO,IAAM,GACf,EAAG,EAAE,EAGL,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAI,EAAW,CAEX,KACF,EAAW,EAAS,GADN,GACY,CAAC,AAAC,GAC1B,EAAS,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC,EAAW,WAAW,IAAA,EAK/D,EAAqB,EACvB,EAAG,CAAC,EAAW,EAAW,EAG1B,IAAM,EAAuB,MAAO,IAElC,GADA,EAAE,cAAc,GACZ,AAAC,EAAS,IAAI,EAAK,EAAD,AAAU,KAAK,EAErC,AAFuC,EAE3B,IACZ,GAAI,CACF,IAAM,EAAO,EAAS,IAAI,CAAC,WAAW,GAChC,EAAS,MAAM,CAAA,EAAA,EAAA,MAAA,AAAM,EAAC,CAAA,EAAA,EAAA,UAAA,AAAU,EAAC,EAAA,EAAE,CAAE,aAAc,MACvD,EACA,KAAM,EAAS,IAAI,CACnB,MAAO,WAAW,EAAS,KAAK,CAAC,QAAQ,IACzC,SAAU,WAAW,EAAS,QAAQ,CAAC,QAAQ,IAC/C,QAAS,SAAS,EAAS,OAAO,CAAC,QAAQ,IAC3C,YAAa,EACb,UAAW,EAAS,SAAS,CAC7B,QAAQ,EACR,WAAY,IAAI,OAAO,WAAW,GAClC,WAAY,IAAI,OAAO,WAAW,EACpC,GAGM,EAAO,CAAA,EAAA,EAAA,aAAA,AAAa,IACpB,EAAa,GAAM,aAAa,OAAS,OAC/C,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,mBAAoB,CACjC,WAAY,EAAO,EAAE,MACrB,EACA,KAAM,EAAS,IAAI,CACnB,MAAO,EAAS,KAAK,AACvB,EAAG,GAEH,EAAY,CACV,KAAM,GACN,KAAM,aACN,MAAO,EACP,SAAU,EACV,QAAS,EACT,UAAW,EACb,GACA,GAAmB,GACnB,GAAY,EACd,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,2BAA4B,GAC1C,GAAY,EACd,EACF,EAGM,EAAqB,MAAO,IAChC,GAAY,GACZ,GAAI,CACF,MAAM,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,CAAA,EAAA,EAAA,GAAA,AAAG,EAAC,EAAA,EAAE,CAAE,YAAa,EAAS,EAAE,EAAG,CACjD,OAAQ,CAAC,EAAS,MAAM,CACxB,WAAY,IAAI,OAAO,WAAW,EACpC,GAGA,IAAM,EAAO,CAAA,EAAA,EAAA,aAAa,AAAb,IACP,EAAa,GAAM,aAAa,YAAS,EAC/C,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,mBAAoB,CACjC,WAAY,EAAS,EAAE,CACvB,KAAM,EAAS,IAAI,CACnB,eAAgB,EAAS,MAAM,CAC/B,UAAW,CAAC,EAAS,MAAM,AAC7B,EAAG,GAEH,EAAY,GACd,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,2BAA4B,GAC1C,GAAY,EACd,CACF,EAGM,EAAe,MAAO,IAC1B,GAAK,CAAD,MAAQ,OAAO,CAAC,+BAA+B,AAEnD,GAAY,GACZ,GAAI,CACF,IAAM,EAAW,EAAU,IAAI,CAAC,GAAK,EAAE,EAAE,GAAK,EAC9C,OAAM,CAAA,EAAA,EAAA,SAAS,AAAT,EAAU,CAAA,EAAA,EAAA,GAAA,AAAG,EAAC,EAAA,EAAE,CAAE,YAAa,IAGrC,IAAM,EAAO,CAAA,EAAA,EAAA,aAAA,AAAa,IACpB,EAAa,GAAM,aAAa,YAAS,EAC/C,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,mBAAoB,YACjC,EACA,KAAM,GAAU,IAClB,EAAG,GAEH,GAAY,EACd,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,2BAA4B,GAC1C,GAAY,EACd,EACF,EAGM,EAAQ,CACZ,WAAY,EAAU,MAAM,CAC5B,YAAa,EAAU,MAAM,CAAC,AAAC,GAAM,EAAE,MAAM,EAAE,MAAM,CACrD,UAAW,EAAU,MAAM,CAAC,CAAC,EAAK,IAAM,EAAM,EAAE,WAAW,CAAE,GAC7D,aAAc,EAAU,MAAM,CAAC,AAAC,GAAM,IAAI,KAAK,EAAE,SAAS,EAAI,IAAI,MAAQ,MAAM,AAClF,EAaA,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,6CAEb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,8CAAqC,mBACnD,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,8BAAqB,oDAIpC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4DACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uEACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAwB,gBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oCAA4B,EAAM,UAAU,MAE7D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uEACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oCAA2B,iBAC1C,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oCAA4B,EAAM,WAAW,MAE9D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uEACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAwB,eACvC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oCAA4B,EAAM,SAAS,MAE5D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uEACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gCAAuB,YACtC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oCAA4B,EAAM,YAAY,SAKjE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,kDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wFACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,OACL,YAAY,2BACZ,MAAO,EACP,SAAU,AAAC,GAAM,EAAc,EAAE,MAAM,CAAC,KAAK,EAC7C,UAAU,2BAEZ,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,GAAmB,GAClC,UAAU,uBACX,wBAOL,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qBACZ,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,kDACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,8EAEc,IAA7B,EAAkB,MAAM,CAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,2CACZ,EAAa,qBAAuB,kDAGvC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,kEACb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,mBACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,wDACf,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,iEAAwD,SACtE,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,iEAAwD,SACtE,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,iEAAwD,UACtE,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,iEAAwD,cACtE,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,iEAAwD,SACtE,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,iEAAwD,YACtE,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,iEAAwD,WACtE,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,iEAAwD,gBAG1E,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,UACE,EAAkB,GAAG,CAAC,AAAC,IACtB,IAAM,EAnFb,IAAI,IAmFmB,CAnFd,AAmFwB,EAAS,SAAS,EAnF7B,IAAI,KAoFb,EA/EK,AAAzB,GAA4B,CAAxB,EAAS,EA+EiB,EA/EK,GAAf,EACb,EAAS,WAAW,EAAI,AA8Ea,EA9EJ,OAAO,CAgFjC,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,CAAqB,UAAU,+DAC9B,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,qBACZ,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,mCAA2B,EAAS,IAAI,KAE1D,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,wCAAgC,EAAS,IAAI,GAC3D,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,6BACO,AAAlB,iBAAS,IAAI,CAAoB,CAAA,EAAG,EAAS,KAAK,CAAC,CAAC,CAAC,CAAG,CAAC,CAAC,EAAE,EAAS,KAAK,CAAC,OAAO,CAAC,GAAA,CAAI,GAE1F,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,CAAG,UAAU,8BAAoB,IAAE,EAAS,QAAQ,CAAC,OAAO,CAAC,MAC9D,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,6BACZ,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAW,EAAU,eAAiB,aACzC,EAAS,WAAW,CACpB,EAAS,OAAO,CAAG,GAAK,CAAC,GAAG,EAAE,EAAS,OAAO,CAAA,CAAE,MAGrD,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,2CACX,IAAI,KAAK,EAAS,SAAS,EAAE,kBAAkB,KAElD,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,qBACZ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uBACZ,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,2GAAkG,YAInH,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,oHAA2G,gBAI5H,CAAC,GAAW,CAAC,GAAW,EAAS,MAAM,EACtC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,uHAA8G,WAI/H,CAAC,GAAW,CAAC,GAAW,CAAC,EAAS,MAAM,EACvC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,8GAAqG,kBAM3H,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,CAAG,UAAU,wCACX,CAAC,GACA,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,EAAmB,GAClC,SAAU,EACV,UAAU,6CAET,EAAS,MAAM,CAAG,UAAY,WAGnC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,EAAa,EAAS,EAAE,EACvC,SAAU,EACV,UAAU,2CACX,gBAxDI,EAAS,EAAE,CA8DxB,YAQT,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gGACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,+BAAsB,yBACpC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,GAAmB,GAClC,UAAU,0CACX,SAKH,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,SAAU,EAAsB,UAAU,sBAE9C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,4CAAmC,SACpD,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,OACL,MAAO,EAAS,IAAI,CACpB,SAAU,AAAC,GAAM,EAAY,CAAE,GAAG,CAAQ,CAAE,KAAM,EAAE,MAAM,CAAC,KAAK,CAAC,WAAW,EAAG,GAC/E,YAAY,iBACZ,UAAU,uBACV,QAAQ,CAAA,CAAA,OAKZ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,4CAAmC,SACpD,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,MAAO,EAAS,IAAI,CACpB,SAAU,AAAC,GAAM,EAAY,CAAE,GAAG,CAAQ,CAAE,KAAM,EAAE,MAAM,CAAC,KAAK,AAA2B,GAC3F,UAAU,iCAEV,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,sBAAa,mBAC3B,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,iBAAQ,2BAK1B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,4CACI,eAAlB,EAAS,IAAI,CAAoB,aAAe,wBAEnD,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,SACL,KAAK,OACL,MAAO,EAAS,KAAK,CACrB,SAAU,AAAC,GAAM,EAAY,CAAE,GAAG,CAAQ,CAAE,MAAO,WAAW,EAAE,MAAM,CAAC,KAAK,CAAE,GAC9E,YAAY,IACZ,UAAU,uBACV,QAAQ,CAAA,CAAA,OAKZ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,4CAAmC,sBACpD,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,SACL,KAAK,OACL,MAAO,EAAS,QAAQ,CACxB,SAAU,AAAC,GAAM,EAAY,CAAE,GAAG,CAAQ,CAAE,SAAU,WAAW,EAAE,MAAM,CAAC,KAAK,CAAE,GACjF,YAAY,IACZ,UAAU,4BAKd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,4CAAmC,6BACpD,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,SACL,MAAO,EAAS,OAAO,CACvB,SAAU,AAAC,GAAM,EAAY,CAAE,GAAG,CAAQ,CAAE,QAAS,SAAS,EAAE,MAAM,CAAC,KAAK,GAAK,CAAE,GACnF,YAAY,IACZ,UAAU,4BAKd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,4CAAmC,oBACpD,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,iBACL,MAAO,EAAS,SAAS,CACzB,SAAU,AAAC,GAAM,EAAY,CAAE,GAAG,CAAQ,CAAE,UAAW,EAAE,MAAM,CAAC,KAAK,AAAC,GACtE,UAAU,uBACV,QAAQ,CAAA,CAAA,OAKZ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4BACb,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,SAAU,EACV,UAAU,8BAET,EAAW,cAAgB,oBAE9B,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,QAAS,IAAM,GAAmB,GAClC,UAAU,wFACX,wBAUjB"}